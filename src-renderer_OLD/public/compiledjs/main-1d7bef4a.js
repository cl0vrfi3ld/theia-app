function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(n)}function i(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(t,n,o,r){return t[1]&&r?e(o.ctx.slice(),t[1](r(n))):o.ctx}function u(t){return null==t?"":t}new Set;function f(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function p(t){t.parentNode&&t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function g(){return d(" ")}function y(){return d("")}function v(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.data!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function k(t,e,n,o){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function $(t,e){return new t(e)}let x;function _(t){x=t}function S(){if(!x)throw new Error("Function called outside component initialization");return x}function j(t){S().$$.on_mount.push(t)}function A(){const t=S();return(e,n,{cancelable:o=!1}={})=>{const r=t.$$.callbacks[e];if(r){const i=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,o,e),r}(e,n,{cancelable:o});return r.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}function O(t){return S().$$.context.get(t)}function T(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}"WeakMap"in("undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global)&&new WeakMap,new Map;const E=[],D=[];let B=[];const C=[],N=Promise.resolve();let P=!1;function U(){P||(P=!0,N.then(H))}function G(){return U(),N}function I(t){B.push(t)}const M=new Set;let J=0;function H(){if(0!==J)return;const t=x;do{try{for(;J<E.length;){const t=E[J];J++,_(t),K(t.$$)}}catch(t){throw E.length=0,J=0,t}for(_(null),E.length=0,J=0;D.length;)D.pop()();for(let t=0;t<B.length;t+=1){const e=B[t];M.has(e)||(M.add(e),e())}B.length=0}while(E.length);for(;C.length;)C.pop()();P=!1,M.clear(),_(t)}function K(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const R=new Set;let q;function L(){q={r:0,c:[],p:q}}function F(){q.r||r(q.c),q=q.p}function W(t,e){t&&t.i&&(R.delete(t),t.i(e))}function Y(t,e,n,o){if(t&&t.o){if(R.has(t))return;R.add(t),q.c.push((()=>{R.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function z(t,e){const n=e.token={};function o(t,o,r,i){if(e.token!==n)return;e.resolved=i;let a=e.ctx;void 0!==r&&(a=a.slice(),a[r]=i);const s=t&&(e.current=t)(a);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(L(),Y(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),F())})):e.block.d(1),s.c(),W(s,1),s.m(e.mount(),e.anchor),c=!0),e.block=s,e.blocks&&(e.blocks[o]=s),c&&H()}if(!(r=t)||"object"!=typeof r&&"function"!=typeof r||"function"!=typeof r.then){if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}else{const n=S();if(t.then((t=>{_(n),o(e.then,1,e.value,t),_(null)}),(t=>{if(_(n),o(e.catch,2,e.error,t),_(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}var r}function V(t,e,n){const o=e.slice(),{resolved:r}=t;t.current===t.then&&(o[t.value]=r),t.current===t.catch&&(o[t.error]=r),t.block.p(o,n)}function X(t,e){const n={},o={},r={$$scope:1};let i=t.length;for(;i--;){const a=t[i],s=e[i];if(s){for(const t in a)t in s||(o[t]=1);for(const t in s)r[t]||(n[t]=s[t],r[t]=1);t[i]=s}else for(const t in a)r[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}function Q(t){return"object"==typeof t&&null!==t?t:{}}function Z(t){t&&t.c()}function tt(t,e,o,a){const{fragment:s,after_update:c}=t.$$;s&&s.m(e,o),a||I((()=>{const e=t.$$.on_mount.map(n).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...e):r(e),t.$$.on_mount=[]})),c.forEach(I)}function et(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];B.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),B=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function nt(e,n,i,a,s,c,u,f=[-1]){const l=x;_(e);const h=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:s,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:o(),dirty:f,skip_bound:!1,root:n.target||l.$$.root};u&&u(h.root);let d=!1;if(h.ctx=i?i(e,n.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return h.ctx&&s(h.ctx[t],h.ctx[t]=r)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](r),d&&function(t,e){-1===t.$$.dirty[0]&&(E.push(t),U(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],h.update(),d=!0,r(h.before_update),h.fragment=!!a&&a(h.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);h.fragment&&h.fragment.l(t),t.forEach(p)}else h.fragment&&h.fragment.c();n.intro&&W(e.$$.fragment),tt(e,n.target,n.anchor,n.customElement),H()}_(l)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);class ot{$destroy(){et(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var rt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function it(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function at(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var st,ct={exports:{}};st=ct,function(){function t(e,n){return n?at(e):e.slice?t[o(e)]:function(n,r){e(n={exports:{}}),t[o(r)]=n.exports};function o(t){return t.split("/").slice(-1).toString().replace(".js","")}}var e=st;t((function(t){String.random=function(t,e){var n="";for(t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t-- >0;)n+=e.charAt(Math.floor(Math.random()*e.length));return n},String.match=function(t,e){var n,o;return"string"==typeof t&&("string"==typeof e&&(e={"=":e}),t===(n=(e=e||{})["="]||e["*"]||e[">"]||e["<"])||o===e["="]&&(n=e["*"]||e[">"],t.slice(0,(n||"").length)===n||o===e["*"]&&(o!==e[">"]&&o!==e["<"]?t>=e[">"]&&t<=e["<"]:o!==e[">"]&&t>=e[">"]||o!==e["<"]&&t<=e["<"])))},String.hash=function(t,e){if("string"==typeof t){if(e=e||0,!t.length)return e;for(var n=0,o=t.length;n<o;++n)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}};var e,n,o,r,i,a,s=Object.prototype.hasOwnProperty;Object.plain=function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])},Object.empty=function(t,e){for(var n in t)if(s.call(t,n)&&(!e||-1==e.indexOf(n)))return!1;return!0},Object.keys=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e},n=setTimeout,o=0,r=0,i=typeof setImmediate!=""+e&&setImmediate||function(t,o){return typeof MessageChannel==""+e?n:((t=new MessageChannel).port1.onmessage=function(t){""==t.data&&o()},function(e){o=e,t.port2.postMessage("")})}(),a=n.check=n.check||typeof performance!=""+e&&performance||{now:function(){return+new Date}},n.hold=n.hold||9,n.poll=n.poll||function(t){n.hold>=a.now()-o&&r++<3333?t():i((function(){o=a.now(),t()}),r=0)},function(){var t,e=setTimeout,n=e.turn=e.turn||function(t){1==o.push(t)&&r(a)},o=n.s=[],r=e.poll,i=0,a=function(){(t=o[i++])&&t(),i!=o.length&&99!=i||(o=n.s=o.slice(i),i=0),o.length&&r(a)}}(),function(){var t,e=setTimeout,n=e.turn;(e.each=e.each||function(e,o,r,i){i=i||9,function a(s,c,u){if(c=(s=(e||[]).splice(0,i)).length){for(var f=0;f<c&&t===(u=o(s[f]));f++);if(t===u)return void n(a)}r&&r(u)}()})()}()}))(t,"./shim"),t((function(t){t.exports=function t(e,n,o){if(!e)return{to:t};var r="function"==typeof n;if(e=(this.tag||(this.tag={}))[e]||r&&(this.tag[e]={tag:e,to:t._={next:function(t){var e;(e=this.to)&&e.next(t)}}}),r){var i={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:n,the:e,on:this,as:o};return(i.back=e.last||e).to=i,e.last=i}return(e=e.to)&&void 0!==n&&e.next(n),e}}))(t,"./onto"),t((function(t){t.exports=function(t){return null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t&&t!=1/0&&t!=-1/0&&t==t||!!t&&"string"==typeof t["#"]&&1===Object.keys(t).length&&t["#"]}}))(t,"./valid"),t((function(e){function n(){var t=+new Date;return s<t?(i=0,s=t+n.drift):s=t+(i+=1)/a+n.drift}t("./shim"),n.drift=0;var o,r=-1/0,i=0,a=999,s=r;n.is=function(t,e,n){var o=e&&t&&t._&&t._[">"]||n;if(o)return"number"==typeof(o=o[e])?o:r},n.ify=function(t,e,n,r,i){(t=t||{})._=t._||{},i&&(t._["#"]=i);var a=t._[">"]||(t._[">"]={});return o!==e&&"_"!==e&&("number"==typeof n&&(a[e]=n),o!==r&&(t[e]=r)),t},e.exports=n}))(t,"./state"),t((function(e){t("./shim"),e.exports=function(t){var e={s:{}},n=e.s;t=t||{max:999,age:9e3},e.check=function(t){return!!n[t]&&o(t)};var o=e.track=function(r){var i=n[r]||(n[r]={});return i.was=e.now=+new Date,e.to||(e.to=setTimeout(e.drop,t.age+9)),o.ed&&o.ed(r),i};return e.drop=function(o){e.to=null,e.now=+new Date;var r=Object.keys(n);console.STAT&&console.STAT(e.now,+new Date-e.now,"dup drop keys"),setTimeout.each(r,(function(r){var i=n[r];i&&(o||t.age)>e.now-i.was||delete n[r]}),0,99)},e}}))(t,"./dup"),t((function(e){t("./onto"),e.exports=function(t,e){if(this.on){var o=(this.opt||{}).lack||9e3;if("function"!=typeof t){if(!t)return;var r=t["#"]||t,i=(this.tag||"")[r];if(!i)return;return e&&(i=this.on(r,e),clearTimeout(i.err),i.err=setTimeout((function(){i.off()}),o)),!0}if(r=e&&e["#"]||n(9),!t)return r;var a=this.on(r,t,e);return a.err=a.err||setTimeout((function(){a.off(),a.next({err:"Error: No ACK yet.",lack:!0})}),o),r}};var n=String.random||function(){return Math.random().toString(36).slice(2)}}))(t,"./ask"),t((function(n){function o(t){return t instanceof o?(this._={$:this}).$:this instanceof o?o.create(this._={$:this,opt:t}):new o(t)}o.is=function(t){return t instanceof o||t&&t._&&t===t._.$||!1},o.version=.202,o.chain=o.prototype,o.chain.toJSON=function(){},t("./shim"),o.valid=t("./valid"),o.state=t("./state"),o.on=t("./onto"),o.dup=t("./dup"),o.ask=t("./ask"),function(){function t(n){if(n)if(n.out!==t){var r,i=this.as,c=i.at||i,u=c.$,f=c.dup,l=n.DBG;if((r=n["#"])||(r=n["#"]=s(9)),!f.check(r)){if(f.track(r),r=n._,n._="function"==typeof r?r:function(){},n.$&&n.$===(n.$._||"").$||(n.$=u),n["@"]&&!n.put&&function(t){var e,n=t["@"]||"";if(e=n._)e.acks=(e.acks||0)+1,(e.err=t.err)&&(t["@"]=e["#"],a(e)),e.ok=t.ok||e.ok,e.stop||e.crack||(e.crack=e.match&&e.match.push((function(){h(e)}))),h(e);else{var o=(o=t.$)&&(o=o._)&&(o=o.root)&&(o=o.dup);if(!(o=o.check(n)))return;t["@"]=o["#"]||t["@"]}}(n),!c.ask(n["@"],n)){if(l&&(l.u=+new Date),n.put)return void e(n);n.get&&o.on.get(n,u)}l&&(l.uc=+new Date),this.to.next(n),l&&(l.ua=+new Date),n.nts||n.NTS||(n.out=t,c.on("out",n),l&&(l.ue=+new Date))}}else this.to.next(n)}function e(e){if(e){var o=e._||"",i=o.root=((o.$=e.$||"")._||"").root;if(e["@"]&&o.faith&&!o.miss)return e.out=t,void i.on("out",e);o.latch=i.hatch,o.match=i.hatch=[];var s=e.put,f=o.DBG=e.DBG,l=+new Date;if(d=d||l,!s["#"]||!s["."]){f&&(f.p=l),o["#"]=e["#"],o.msg=e,o.all=0,o.stun=1;var p=Object.keys(s);console.STAT&&console.STAT(l,((f||o).pk=+new Date)-l,"put sort");var h,v,m,b,k,$,x,_=0;!function t(i){if(h!=_){if(h=_,!(m=p[_]))return console.STAT&&console.STAT(l,((f||o).pd=+new Date)-l,"put"),void a(o);(b=s[m])?(x=b._)?m!==x["#"]?$=g+y(m)+"soul not same.":(k=x[">"])||($=g+y(m)+"no state."):$=g+y(m)+"no meta.":$=g+y(m)+"no node.",v=Object.keys(b||{})}if($)return e.err=o.err=$,void a(o);var d,S=0;for(i=i||0;i++<9&&(d=v[S++]);)if("_"!==d){var j=b[d],A=k[d];if(r===A){$=g+y(d)+"on"+y(m)+"no state.";break}if(!u(j)){$=g+y(d)+"on"+y(m)+"bad "+typeof j+y(j);break}n(j,d,m,A,e),++w}(v=v.slice(S)).length?c(t):(++_,v=null,t(i))}()}}}function n(t,e,o,r,i){var a,s=i._||"",c=s.root,u=c.graph,l=u[o]||p,h=f(l,e,1),d=l[e],g=s.DBG;(a=console.STAT)&&(u[o]&&d||(a.has=(a.has||0)+1));var y=b();if(r>y)return setTimeout((function(){n(t,e,o,r,i)}),(a=r-y)>m?m:a),void(console.STAT&&console.STAT((g||s).Hf=+new Date,a,"future"));if(!(r<h)&&(s.faith||r!==h||!(t===d||v(t)<=v(d))||s.miss)){s.stun++;var w=i["#"]+s.all++,k={toString:function(){return w},_:s};k.toJSON=k.toString,c.dup.track(k)["#"]=i["#"],g&&(g.ph=g.ph||+new Date),c.on("put",{"#":k,"@":i["@"],put:{"#":o,".":e,":":t,">":r},ok:i.ok,_:s})}}function i(t){var e;(e=(t._||"").DBG)&&(e.pa=+new Date,e.pm=e.pm||+new Date);var n,o=this.as,r=o.graph,i=t._,s=t.put,c=s["#"],u=s["."],f=s[":"],p=s[">"];t["#"],(n=i.msg)&&(n=n.put)&&(n=n[c])&&l(n,u,p,f,c),r[c]=l(r[c],u,p,f,c),(n=(o.next||"")[c])&&n.on("in",t),a(i),this.to.next(t)}function a(e,n){var o;if(!e.stop&&(e.err||!(0<--e.stun))&&(e.stop=1,o=e.root)){var r=e.match;r.end=1,r===o.hatch&&(!(r=e.latch)||r.end?delete o.hatch:o.hatch=r),e.hatch&&e.hatch(),setTimeout.each(e.match,(function(t){t&&t()})),!(n=e.msg)||e.err||n.err||(n.out=t,e.root.on("out",n),k())}}function h(t){t&&t.root&&(t.stun||t.acks!==t.all||t.root.on("in",{"@":t["#"],err:t.err,ok:t.err?r:t.ok||{"":1}}))}o.create=function(e){e.root=e.root||e,e.graph=e.graph||{},e.on=e.on||o.on,e.ask=e.ask||o.ask,e.dup=e.dup||o.dup();var n=e.$.opt(e.opt);return e.once||(e.on("in",t,e),e.on("out",t,e),e.on("put",i,e),o.on("create",e),e.on("create",e)),e.once=1,n},o.on.put=e;var d,g="Error: Invalid graph!",y=function(t){return" '"+(""+t).slice(0,9)+"...' "},v=JSON.stringify,m=2147483647,b=o.state,w=0,k=function(){w>999&&w/-(d-(d=+new Date))>1&&(o.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),k=function(){w=0})}}(),function(){function t(t,e){var n=+new Date,o=t._||{},i=o.DBG=t.DBG,a=t["#"],c=s(9),u=Object.keys(e||"").sort(),p=((e||"")._||"")["#"];u.length;var h=t.$._.root,d=e===h.graph[p];console.STAT&&console.STAT(n,((i||o).gk=+new Date)-n,"got keys"),e&&function t(){n=+new Date;for(var o,g,y,v=0,m={};v<9&&(o=u[v++]);)l(m,o,f(e,o),e[o],p);u=u.slice(v),(g={})[p]=m,m=g,d&&((y=function(){}).ram=y.faith=!0),g=u.length,console.STAT&&console.STAT(n,-(n-(n=+new Date)),"got copied some"),i&&(i.ga=+new Date),h.on("in",{"@":a,"#":c,put:m,"%":g?c=s(9):r,$:h.$,_:y,DBG:i,FOO:1}),console.STAT&&console.STAT(n,+new Date-n,"got in"),g&&setTimeout.turn(t)}(),e||h.on("in",{"@":t["#"]})}o.on.get=function(e,n){var o=n._,i=e.get,a=i["#"],s=o.graph[a],c=i["."],u=(o.next||(o.next={}))[a],p=(e._||{}).DBG=e.DBG;if(p&&(p.g=+new Date),!s)return o.on("get",e);if(c){if(("string"!=typeof c||r===s[c])&&!((u||"").next||"")[c])return void o.on("get",e);s=l({},c,f(s,c),s[c],a)}s&&t(e,s),o.on("get",e)},o.on.get.ack=t}(),o.chain.opt=function(t){t=t||{};var e=this._,n=t.peers||t;return Object.plain(t)||(t={}),Object.plain(e.opt)||(e.opt=t),"string"==typeof n&&(n=[n]),Object.plain(e.opt.peers)||(e.opt.peers={}),n instanceof Array&&(t.peers={},n.forEach((function(n){var o={};o.id=o.url=n,t.peers[n]=e.opt.peers[n]=e.opt.peers[n]||o}))),a(t,(function t(e){var n=this[e];this&&this.hasOwnProperty(e)||"string"==typeof n||Object.empty(n)?this[e]=n:(!n||n.constructor===Object||n instanceof Array)&&a(n,t)})),e.opt.from=t,o.on("opt",e),e.opt.uuid=e.opt.uuid||function(t){return o.state().toString(36).replace(".","")+String.random(t||12)},this};var r,i,a=function(t,e){Object.keys(t).forEach(e,t)},s=String.random,c=setTimeout.turn,u=o.valid,f=o.state.is,l=o.state.ify,p={};o.log=function(){return!o.log.off&&i.log.apply(i,arguments),[].slice.call(arguments).join(" ")},o.log.once=function(t,e,n){return(n=o.log.once)[t]=n[t]||0,n[t]++||o.log(e)},"undefined"!=typeof window&&((window.GUN=window.Gun=o).window=window);try{void 0!==e&&(e.exports=o)}catch(t){}n.exports=o,(o.window||{}).console=(o.window||{}).console||{log:function(){}},(i=console).only=function(t,e){return i.only.i&&t===i.only.i&&i.only.i++&&(i.log.apply(i,arguments)||e)},o.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")}))(t,"./root"),t((function(e){t("./root").chain.back=function(t,e){if(-1===(t=t||1)||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var r=this._;if("string"==typeof t&&(t=t.split(".")),t instanceof Array){for(var i=0,a=t.length,s=r;i<a;i++)s=(s||o)[t[i]];return n!==s?e?this:s:(s=r.back)?s.$.back(t,e):void 0}if("function"==typeof t){var c;for(s={back:r};(s=s.back)&&n===(c=t(s,e)););return c}return"number"==typeof t?(r.back||r).$.back(t-1):this};var n,o={}}))(t,"./back"),t((function(e){var n=t("./root");function o(t,e){if(e=e||this.as||t.$._,(!t.$$||this===n.on)&&t.put&&!e.soul){var o=t.put||"",r=o["="]||o[":"],i=e.root,a=i.$.get(o["#"]).get(o["."])._;if("string"==typeof(r=u(r))){if(!(a.echo||(a.echo={}))[e.id]||(i.pass||"")[e.id]){if(s=i.pass){if(s[r+e.id])return;s[r+e.id]=1}(a.echo||(a.echo={}))[e.id]=e,e.has&&(e.link=r);var s,c=i.$.get(a.link=r)._;(c.echo||(c.echo={}))[a.id]=a,((s=e.ask||"")[""]||e.lex)&&c.on("out",{get:{"#":r}}),setTimeout.each(Object.keys(s),(function(t,e){t&&(e=s[t])&&e.on("out",{get:{"#":r,".":t}})}),0,99)}}else this===n.on&&((a.echo||(a.echo={}))[e.id]=e)}}function r(t,e){var n,o,i=t.put||"",s=a!==i["="]?i["="]:i[":"],c=e.root;if(a===s){if(e.soul&&a!==e.put)return;if(o=(t.$$||t.$||"")._||"",t["@"]&&(a!==o.put||a!==e.put))return;return(n=e.link||t.linked)&&delete(c.$.get(n)._.echo||"")[e.id],e.has&&(e.link=null),e.put=a,void setTimeout.each(Object.keys(e.next||""),(function(t,o){(o=e.next[t])&&(n&&delete(c.$.get(n).get(t)._.echo||"")[o.id],o.on("in",{get:t,put:a,$:o.$}))}),0,99)}e.soul||t.$$||(n=u(s),o=t.$._||"",(n!==o.link&&(!e.has||o.link)||(c.pass||"")[e.id]&&"string"!=typeof n)&&(delete(o.echo||"")[e.id],r({get:e.get,put:a,$:t.$,linked:t.linked=t.linked||o.link},e)))}function i(t,e){var o=this.as,r=o.$._;r.root;var i=o.get||"",s=(t.put||"")[i["#"]]||"";if(!t.put||"string"==typeof i["."]&&a===s[i["."]]){if(a!==r.put)return;if(!r.soul&&!r.has)return;return r.ack=(r.ack||0)+1,void r.on("in",{get:r.get,put:r.put=a,$:r.$,"@":t["@"]})}(t._||{}).miss=1,n.on.put(t)}n.chain.chain=function(t){var e,o=this,r=o._,i=new(t||o).constructor(o),a=i._;return a.root=e=r.root,a.id=++e.once,a.back=o._,a.on=n.on,a.on("in",n.on.in,a),a.on("out",n.on.out,a),i},n.on.out=function(t){var e,n,o=this.as,r=o.back,s=o.root;if(t.$||(t.$=o.$),this.to.next(t),!o.err){if(e=t.get){if(s.pass&&(s.pass[o.id]=o),o.lex&&Object.keys(o.lex).forEach((function(t){n[t]=o.lex[t]}),n=t.get=t.get||{}),e["#"]||o.soul){if(e["#"]=e["#"]||o.soul,t["#"]||(t["#"]=c(9)),r=s.$.get(e["#"])._,e=e["."]){if(f(r.put,e)&&(n=r.ask&&r.ask[e],(r.ask||(r.ask={}))[e]=r.$.get(e)._,r.on("in",{get:e,put:{"#":r.soul,".":e,":":r.put[e],">":p(s.graph[r.soul],e)}}),n))return}else{if(n=r.ask&&r.ask[""],(r.ask||(r.ask={}))[""]=r,a!==r.put&&(r.on("in",r),n))return;t.$=r.$}return s.ask(i,t),s.on("in",t)}if(e["."])return o.get?(t={get:{".":o.get},$:o.$},(r.ask||(r.ask={}))[o.get]=t.$._,r.on("out",t)):(t={get:o.lex?t.get:{},$:o.$},r.on("out",t));if((o.ask||(o.ask={}))[""]=o,o.get)return e["."]=o.get,(r.ask||(r.ask={}))[o.get]=t.$._,r.on("out",t)}return r.on("out",t)}o.on("in",{put:o.put=a,$:o.$})},n.on.in=function(t,e){var n,i=(e=e||this.as).root,c=t.$||(t.$=e.$),f=(c||"")._||s,l=t.put||"",d=l["#"],g=l["."],y=a!==l["="]?l["="]:l[":"],v=l[">"]||-1/0;if(a!==t.put&&(a===l["#"]||a===l["."]||a===l[":"]&&a===l["="]||a===l[">"]))return u(l)?void e.on("in",{$:f.back.$,put:{"#":d=f.back.soul,".":g=f.has||f.get,"=":l,">":p(f.back.put,g)},via:t}):(d=((l||"")._||"")["#"])?(c=e.root.$.get(d),setTimeout.each(Object.keys(l).sort(),(function(n){"_"!=n&&a!==(v=p(l,n))&&e.on("in",{$:c,put:{"#":d,".":n,"=":l[n],">":v},VIA:t})}))):void console.log("chain not yet supported for",l,"...",t,e);(t.seen||"")[e.id]||((t.seen||(t.seen=function(){}))[e.id]=e,e!==f&&(Object.keys(t).forEach((function(e){l[e]=t[e]}),l={}),l.get=e.get||l.get,e.soul||e.has?f.soul&&(l.$=e.$,l.$$=l.$$||f.$):l.$$$=l.$$$||e.$,t=l),r(t,e),(e.soul||t.$$)&&v>=p(i.graph[d],g)&&((l=i.$.get(d)._).put=h(l.put,g,v,y,d)),!f.soul&&v>=p(i.graph[d],g)&&(n=(i.$.get(d)._.next||"")[g])&&(n.put=y,"string"==typeof(l=u(y))&&(n.put=i.$.get(l)._.put||y)),this.to&&this.to.next(t),e.any&&setTimeout.each(Object.keys(e.any),(function(n){(n=e.any[n])&&n(t)}),0,99),e.echo&&setTimeout.each(Object.keys(e.echo),(function(n){(n=e.echo[n])&&n.on("in",t)}),0,99),((t.$$||"")._||f).soul&&(n=e.next)&&(n=n[g])&&(l={},Object.keys(t).forEach((function(e){l[e]=t[e]})),l.$=(t.$$||t.$).get(l.get=g),delete l.$$,delete l.$$$,n.on("in",l)),o(t,e))},n.on.link=o,n.on.unlink=r;var a,s={},c=String.random,u=n.valid,f=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},l=n.state,p=l.is,h=l.ify}))(t,"./chain"),t((function(e){var n=t("./root");function o(t){var e=this.at||this.on;if(!t||e.soul||e.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var n;if(e.map,(n=this.seen||(this.seen={}))[t])return!0;n[t]=!0}}n.chain.get=function(t,e,s){var c,u;if("string"==typeof t){if(0==t.length)return(c=this.chain())._.err={err:n.log("0 length key!",t)},e&&e.call(c,c._.err),c;(c=((l=this._).next||i)[t])||(c=t&&function(t,e){var n=e._,o=n.next,r=e.chain(),i=r._;return o||(o=n.next={}),o[i.get=t]=i,e===n.root.$?i.soul=t:(n.soul||n.has)&&(i.has=t),i}(t,this)),c=c&&c.$}else{if("function"==typeof t){if(!0===e)return function(t,e,o,i){var a,s=t._,c=0;(a=s.soul||s.link)?e(a,i,s):s.jam?s.jam.push([e,i]):(s.jam=[[e,i]],t.get((function(t,e){if(!(r===t.put&&!s.root.opt.super&&(a=Object.keys(s.root.opt.peers).length)&&++c<=a)){e.rid(t);var o,i=(i=t.$)&&i._||{},u=0;for(a=s.jam,delete s.jam;o=a[u++];){var f=o[0];o=o[1],f&&f(i.link||i.soul||n.valid(t.put)||((t.put||{})._||{})["#"],o,t,e)}}}),{out:{get:{".":!0}}}))}(this,t,0,s),this;var f,l=(c=this)._,p=e||{},h=l.root;p.at=l,p.ok=t;var d={};function g(t,e,o){if(!g.stun&&(!(i=h.pass)||i[f])){var i,a=t.$._,s=(t.$$||"")._,c=(s||a).put,u=!a.has&&!a.soul,y={};if((u||r===c)&&(c=r===((i=t.put)||"")["="]?r===(i||"")[":"]?i:i[":"]:i["="]),"string"==typeof(i=n.valid(c))&&(c=r===(i=h.$.get(i)._.put)?p.not?r:c:i),!p.not||r!==c){if(r===p.stun){if((i=h.stun)&&i.on&&(l.$.back((function(t){if(i.on(""+t.id,y={}),(y.run||0)<g.id)return y})),!y.run&&i.on(""+a.id,y={}),!y.run&&s&&i.on(""+s.id,y={}),g.id>y.run&&(y.stun&&!y.stun.end||(y.stun=i.on("stun"),y.stun=y.stun&&y.stun.last),y.stun&&!y.stun.end)))return void((y.stun.add||(y.stun.add={}))[f]=function(){g(t,e,1)});if(r===c&&(o=0),(i=h.hatch)&&!i.end&&r===p.hatch&&!o){if(d[a.$._.id])return;return d[a.$._.id]=1,void i.push((function(){g(t,e,1)}))}d={}}if(h.pass){if(h.pass[f+a.id])return;h.pass[f+a.id]=1}p.on?p.ok.call(a.$,c,a.get,t,e||g):p.v2020?p.ok(t,e||g):(Object.keys(t).forEach((function(e){i[e]=t[e]}),i={}),(t=i).put=c,p.ok.call(p.as,t,e||g))}}}return g.at=l,(l.any||(l.any={}))[f=String.random(7)]=g,g.off=function(){g.stun=1,l.any&&delete l.any[f]},g.rid=o,g.id=p.run||++h.once,u=h.pass,(h.pass={})[f]=1,p.out=p.out||{get:{}},l.on("out",p.out),h.pass=u,c}if("number"==typeof t)return this.get(""+t,e,s);if("string"==typeof(u=a(t)))return this.get(u,e,s);(u=this.get.next)&&(c=u(this,t))}return c?(e&&"function"==typeof e&&c.get(e,s),c):((c=this.chain())._.err={err:n.log("Invalid get request!",t)},e&&e.call(c,c._.err),c)};var r,i={},a=n.valid}))(t,"./get"),t((function(e){var n=t("./root");function o(t,e){if(e){e=(e._||"").id||e;var o,r=t.root.stun||(t.root.stun={on:n.on}),i={};t.stun||(t.stun=r.on("stun",(function(){}))),(o=r.on(""+e))&&o.the.last.next(i),i.run>=t.run||r.on(""+e,(function(e){if(t.stun.end)return this.off(),void this.to.next(e);e.run=e.run||t.run,e.stun=e.stun||t.stun}))}}function r(t){if(t.err)r.end(t.stun,t.root);else if(!t.todo.length&&!t.end&&Object.empty(t.wait)){t.end=1;var e,o=t.$.back(-1)._,i=o.root,a=o.ask((function(e){i.on("ack",e),e.err&&!e.lack&&n.log(e),++s>(t.acks||0)&&this.off(),t.ack&&t.ack(e,this)}),t.opt),s=0,c=t.stun;(e=function(){c&&(r.end(c,i),setTimeout.each(Object.keys(c=c.add||""),(function(t){(t=c[t])&&t()})))}).hatch=e,t.ack&&!t.ok&&(t.ok=t.acks||9),t.via._.on("out",{put:t.out=t.graph,ok:t.ok&&{"@":t.ok+1},opt:t.opt,"#":a,_:e})}}n.chain.put=function(t,e,a){var f=this,l=f._,p=l.root;(a=a||{}).root=l.root,a.run||(a.run=p.once),o(a,l.id),a.ack=a.ack||e,a.via=a.via||f,a.data=a.data||t,a.soul||(a.soul=l.soul||"string"==typeof e&&e);var h=a.state=a.state||n.state();return"function"==typeof t?(t((function(t){a.data=t,f.put(i,i,a)})),f):a.soul?(a.$=p.$.get(a.soul),a.todo=[{it:a.data,ref:a.$}],a.turn=a.turn||s,a.ran=a.ran||r,function t(){var e,i,s,f,l,p=a.todo,d=p.pop(),g=d.it;if(d.ref&&d.ref._.id,o(a,d.ref),(f=d.todo)&&(g=g[i=f.pop()],f.length&&p.push(d)),i&&(p.path||(p.path=[])).push(i),!(e=c(g))&&!(l=n.is(g))){if(!Object.plain(g))return void r.err(a,"Invalid data: "+function(t,e){return t&&(e=t.constructor)&&e.name||typeof t}(g)+" at "+(a.via.back((function(t){t.get&&f.push(t.get)}),f=[])||f.join("."))+"."+(p.path||[]).join("."));for(var y=a.seen||(a.seen=[]),v=y.length;v--;)if(g===(f=y[v]).it){e=g=f.link;break}}if(i&&e)d.node=u(d.node,i,h,g);else{if(!a.seen)return void r.err(a,"Data at root of graph must be a node (an object).");a.seen.push(s={it:g,link:{},todo:l?[]:Object.keys(g).sort().reverse(),path:(p.path||[]).slice(),up:d}),d.node=u(d.node,i,h,s.link),!l&&s.todo.length&&p.push(s);var m=a.seen.length;function b(t,e){var n=s.link["#"];e&&(e.off(),e.rid(t));var r=n||t.soul||(f=(t.$$||t.$)._||"").soul||f.link||((f=f.put||"")._||"")["#"]||f["#"]||((f=t.put||"")&&t.$$?f["#"]:(f["="]||f[":"]||"")["#"]);!n&&o(a,t.$),r||d.link["#"]?(r||(r=[],(t.$$||t.$).back((function(t){if(f=t.soul||t.link)return r.push(f);r.push(t.get)})),r=r.reverse().join("/")),s.link["#"]=r,!l&&(((a.graph||(a.graph={}))[r]=s.node||(s.node={_:{}}))._["#"]=r),delete a.wait[m],s.wait&&setTimeout.each(s.wait,(function(t){t&&t()})),a.ran(a)):(d.wait||(d.wait=[])).push((function(){b(t,e)}))}(a.wait||(a.wait={}))[m]="",f=(s.ref=l?g:i?d.ref.get(i):d.ref)._,(f=g&&(g._||"")["#"]||f.soul||f.link)?b({soul:f}):s.ref.get(b,{run:a.run,v2020:1,out:{get:{".":" "}}})}if(!p.length)return a.ran(a);a.turn(t)}(),f):(function(t){var e,n=t.via._;t.via=t.via.back((function(n){if(n.soul||!n.get)return n.$;e=t.data,(t.data={})[n.get]=e})),t.via&&t.via._.soul||(t.via=n.root.$.get(((t.data||"")._||"")["#"]||n.$.back("opt.uuid")())),t.via.put(t.data,t.ack,t)}(a),f)},r.end=function(t,e){t.end=a,t.the.to===t&&t===t.the.last&&delete e.stun,t.off()},r.err=function(t,e){(t.ack||a).call(t,t.out={err:t.err=n.log(e)}),t.ran(t)};var i,a=function(){},s=setTimeout.turn,c=n.valid,u=n.state.ify}))(t,"./put"),t((function(e){var n=t("./root");t("./chain"),t("./back"),t("./put"),t("./get"),e.exports=n}))(t,"./index"),t((function(e){var n,o=t("./index");o.chain.on=function(t,e,n,o){var r,i=this,a=i._;if(a.root,"string"==typeof t)return e?(r=a.on(t,e,n||a,o),n&&n.$&&(n.subs||(n.subs=[])).push(r),i):a.on(t);var s=e;return(s=!0===s?{change:!0}:s||{}).not=1,s.on=1,i.get(t,s),i},o.chain.once=function(t,e){if(e=e||{},!t)return function(t,e,n){return o.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(n=t.chain())._.nix=t.once((function(t,e){n._.on("in",this._)})),n._.lex=t._.lex,n}(this);var r=this,i=r._,a=i.root;i.put;var s,c=String.random(7);return r.get((function(r,u,f,l){var p=this,h=p._,d=h.one||(h.one={});function g(y){h.has||h.soul||(h={put:r,get:u}),n===(s=h.put)&&(s=((f.$$||"")._||"").put),"string"!=typeof o.valid(s)||(s=a.$.get(s)._.put)!==n||y?l.stun||""!==d[c]&&(d[c]="",(i.soul||i.has)&&l.off(),t.call(p,s,h.get),clearTimeout(d[c])):d[c]=setTimeout((function(){g(1)}),e.wait||99)}l.stun||""!==d[c]&&(!0!==(s=o.valid(r))?"string"!=typeof s&&(clearTimeout((i.one||"")[c]),clearTimeout(d[c]),d[c]=setTimeout(g,e.wait||99)):g())}),{on:1}),r},o.chain.off=function(){var t,e=this._,n=e.back;if(n)return e.ack=0,(t=n.next)&&t[e.get]&&delete t[e.get],(t=n.any)&&(delete n.any,n.any={}),(t=n.ask)&&delete t[e.get],(t=n.put)&&delete t[e.get],(t=e.soul)&&delete n.root.graph[t],(t=e.map)&&Object.keys(t).forEach((function(e,o){(o=t[e]).link&&n.root.$.get(o.link).off()})),(t=e.next)&&Object.keys(t).forEach((function(e,n){t[e].$.off()})),e.on("off",{}),this}}))(t,"./on"),t((function(e){var n=t("./index"),o=n.chain.get.next;function r(t){this.to.next(t);var e,o=this.as,r=t.$._,i=t.put;(r.soul||t.$$)&&((e=o.lex)&&!String.match(t.get||(i||"")["."],e["."]||e["#"]||e)||n.on.link(t,o))}n.chain.get.next=function(t,e){var n;return Object.plain(e)?(n=((n=e["#"])||"")["="]||n)?t.get(n):((n=t.chain()._).lex=e,t.on("in",(function(t){String.match(t.get||(t.put||"")["."],e["."]||e["#"]||e)&&n.on("in",t),this.to.next(t)})),n.$):(o||a)(t,e)},n.chain.map=function(t,e,o){var s,c,u=this,f=u._;return Object.plain(t)&&(s=t["."]?t:{".":t},t=i),t?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),c=u.chain(),u.map().on((function(e,o,r,s){var u=(t||a).call(this,e,o,r,s);if(i!==u){if(e===u)return c._.on("in",r);if(n.is(u))return c._.on("in",u._);var f={};Object.keys(r.put).forEach((function(t){f[t]=r.put[t]}),f),f["="]=u,c._.on("in",{get:o,put:f})}})),c):((c=f.each)||((f.each=c=u.chain())._.lex=s||c._.lex||f.lex,c._.nix=u.back("nix"),u.on("in",r,c._)),c)};var i,a=function(){}}))(t,"./map"),t((function(e){var n=t("./index");n.chain.set=function(t,e,o){var r,i,a=this,s=a.back(-1);return e=e||function(){},(o=o||{}).item=o.item||t,(r=((t||"")._||"")["#"])&&((t={})["#"]=r),"string"==typeof(i=n.valid(t))?a.get(r=i).put(t,e,o):n.is(t)?(a.put((function(o){t.get((function(t,r,s){if(!t)return e.call(a,{err:n.log('Only a node can be linked! Not "'+s.put+'"!')});(i={})[t]={"#":t},o(i)}),!0)})),t):(Object.plain(t)&&(t=s.get(r=a.back("opt.uuid")()).put(t)),a.get(r||s.back("opt.uuid")(7)).put(t,e,o))}}))(t,"./set"),t((function(e){t("./shim");var n,o=function(){},r=JSON.parseAsync||function(t,e,n){var o=+new Date;try{e(void 0,JSON.parse(t,n),i.sucks(+new Date-o))}catch(t){e(t)}},i=JSON.stringifyAsync||function(t,e,n,o){var r=+new Date;try{e(void 0,JSON.stringify(t,n,o),i.sucks(+new Date-r))}catch(t){e(t)}};i.sucks=function(t){t>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),i.sucks=o)};try{e.exports=function(t){var e=function(){},o=t.opt||{};o.log=o.log||console.log,o.gap=o.gap||o.wait||0,o.max=o.max||.3*(o.memory?999*o.memory*999:3e8),o.pack=o.pack||.01*o.max*.01,o.puff=o.puff||9;var a=setTimeout.turn||setTimeout,s=t.dup,c=s.check,u=s.track,f=e.hear=function(t,n){if(t){if(o.max<=t.length)return e.say({dam:"!",err:"Message too big!"},n);e===this&&(f.d+=t.length||0,++f.c);var i,s=n.SH=+new Date,c=t[0];return"["===c?(r(t,(function(t,r){if(t||!r)return e.say({dam:"!",err:"DAM JSON parse error."},n);console.STAT&&console.STAT(+new Date,r.length,"# on hear batch");var i=o.puff;!function t(){for(var o,s=+new Date,c=0;c<i&&(o=r[c++]);)e.hear(o,n);r=r.slice(c),console.STAT&&console.STAT(s,+new Date-s,"hear loop"),l(n),r.length&&a(t,0)}()})),void(t="")):"{"===c||(t["#"]||Object.plain(t))&&(i=t)?i?f.one(i,n,s):void r(t,(function(t,o){if(t||!o)return e.say({dam:"!",err:"DAM JSON parse error."},n);f.one(o,n,s)})):void 0}};function l(t){var e=t.batch,n="string"==typeof e;if(n&&(e+="]"),t.batch=t.tail=null,e&&!(n?3>e.length:!e.length)){if(!n)try{e=1===e.length?e[0]:JSON.stringify(e)}catch(t){return o.log("DAM JSON stringify error",t)}e&&p(e,t)}}function p(t,n){try{var o=n.wire;n.say?n.say(t):o.send&&o.send(t),e.say.d+=t.length||0,++e.say.c}catch(e){(n.queue=n.queue||[]).push(t)}}return f.one=function(n,o,r){var i,a,f,l,p;if(n.DBG&&(n.DBG=p={DBG:n.DBG}),p&&(p.h=r),p&&(p.hp=+new Date),(i=n["#"])||(i=n["#"]=String.random(9)),!((f=c(i))||(a=n["##"])&&(f=n["@"]||n.get&&i)&&s.check(l=f+a))){if((n._=function(){}).via=e.leap=o,(f=n["><"])&&"string"==typeof f&&f.slice(0,99).split(",").forEach((function(t){this[t]=1}),n._.yo={}),f=n.dam)return(f=e.hear[f])&&f(n,o,t),void u(i);(f=n.ok)&&(n._.near=f["/"]),r=+new Date,p&&(p.is=r),o.SI=i,u.ed=function(t){i===t&&(u.ed=0,(t=s.s[i])&&(t.via=o,n.get&&(t.it=n)))},t.on("in",e.last=n),p&&(p.hd=+new Date),console.STAT&&console.STAT(r,+new Date-r,n.get?"msg get":n.put?"msg put":"msg"),u(i),l&&u(l),e.leap=e.last=null}},f.c=f.d=0,function(){var t,r=0;function f(t,e){var n;return e instanceof Object?(Object.keys(e).sort().forEach(h,{to:n={},on:e}),n):e}function h(t){this.to[t]=this.on[t]}e.hash=function(t,n){var o,r,s,c=+new Date;i(t.put,(function i(u,f){var l=(r||(r=s=f||"")).slice(0,32768);o=String.hash(l,o),(r=r.slice(32768))?a(i,0):(console.STAT&&console.STAT(c,+new Date-c,"say json+hash"),t._.$put=s,t["##"]=o,e.say(t,n),delete t._.$put)}),f)},e.say=function(i,c){var f;if((f=this)&&(f=f.to)&&f.next&&f.next(i),!i)return!1;var h,d,g,y=i["@"],v=i._||(i._=function(){}),m=i.DBG,b=+new Date;if(v.y=v.y||b,c||m&&(m.y=b),(h=i["#"])||(h=i["#"]=String.random(9)),!t&&u(h),(d=i["##"])||n===i.put||v.via||!y){if(!c&&y&&(c=(f=s.s[y])&&(f.via||(f=f.it)&&(f=f._)&&f.via)||(f=e.last)&&y===f["#"]&&e.leap),!c&&y){if(s.s[y])return;return console.STAT&&console.STAT(+new Date,++r,"total no peer to ack to"),!1}if(y&&!i.put&&!d&&((s.s[y]||"").it||"")["##"])return!1;if(!c&&e.way)return e.way(i);if(m&&(m.yh=+new Date),g=v.raw){if(m&&(m.yr=+new Date),!c||!c.id){if(!Object.plain(c||o.peers))return!1;b=+new Date,o.puff;var w=o.peers,k=Object.keys(c||o.peers||{});return console.STAT&&console.STAT(b,+new Date-b,"peer keys"),void function n(){var o=+new Date;t=1;var r=v.raw;v.raw=g;for(var s,f=0;f<9&&(s=(k||"")[f++]);)(s=w[s]||(c||"")[s])&&e.say(i,s);v.raw=r,t=0,k=k.slice(f),console.STAT&&console.STAT(o,+new Date-o,"say loop"),k.length&&(a(n,0),y&&u(y))}()}if(!c.wire&&e.wire&&e.wire(c),h!==c.last){if(c.last=h,c===v.via)return!1;if((f=v.yo)&&(f[c.url]||f[c.pid]||f[c.id]))return!1;if(console.STAT&&console.STAT(b,((m||v).yp=+new Date)-(v.y||b),"say prep"),!t&&y&&u(y),c.batch){if(c.tail=(f=c.tail||0)+g.length,c.tail<=o.pack)return void(c.batch+=(f?",":"")+g);l(c)}c.batch="[";var $=+new Date;setTimeout((function(){console.STAT&&console.STAT($,+new Date-$,"0ms TO"),l(c)}),o.gap),p(g,c),console.STAT&&y===c.SI&&console.STAT(b,+new Date-c.SH,"say ack")}}else e.raw(i,c)}else e.hash(i,c)},e.say.c=e.say.d=0,e.raw=function(t,r){if(!t)return"";var a,u,f=t._||{};if(u=f.raw)return u;if("string"==typeof t)return t;var l=t["##"],p=t["@"];if(l&&p){if(!f.via&&c(p+l))return!1;if(u=(s.s[p]||"").it){if(l===u["##"])return!1;u["##"]||(u["##"]=l)}}if(!t.dam&&!t["@"]){var h=0,d=[];for(var g in u=o.peers){var y=u[g];if(d.push(y.url||y.pid||y.id),++h>6)break}h>1&&(t["><"]=d.join())}if(t.put&&(u=t.ok)&&(t.ok={"@":(u["@"]||1)-1,"/":u["/"]==t._.near?e.near:u["/"]}),a=f.$put)return u={},Object.keys(t).forEach((function(e){u[e]=t[e]})),u.put=":])([:",void i(u,(function(t,e){if(!t){var o=+new Date;u=e.indexOf('"put":":])([:"'),v(n,e=e.slice(0,u+6)+a+e.slice(u+14)),console.STAT&&console.STAT(o,+new Date-o,"say slice")}}));function v(n,o){n||(f.raw=o,e.say(t,r))}i(t,v)}}(),e.near=0,e.hi=function(n){var r;n.wire?(n.id?o.peers[n.url||n.id]=n:(r=n.id=n.id||n.url||String.random(9),e.say({dam:"?",pid:t.opt.pid},o.peers[r]=n),delete s.s[n.last]),n.met||(e.near++,n.met=+new Date,t.on("hi",n)),r=n.queue,n.queue=[],setTimeout.each(r||[],(function(t){p(t,n)}),0,9)):e.wire(n.length&&{url:n,id:n}||n)},e.bye=function(n){n.met&&--e.near,delete n.met,t.on("bye",n);var o=+new Date;o-=n.met||o,e.bye.time=((e.bye.time||o)+o)/2},e.hear["!"]=function(t,e){o.log("Error:",t.err)},e.hear["?"]=function(t,n){t.pid&&(n.pid||(n.pid=t.pid),t["@"])||(e.say({dam:"?",pid:o.pid,"@":t["#"]},n),delete s.s[n.last])},e.hear.mob=function(t,n){if(t.peers){var o=Object.keys(t.peers),r=o[Math.random()*o.length>>0];r&&(e.bye(n),e.hi(r))}},t.on("create",(function(t){t.opt.pid=t.opt.pid||String.random(9),this.to.next(t),t.on("out",e.say)})),t.on("bye",(function(t,e){t=o.peers[t.id||t]||t,this.to.next(t),t.bye?t.bye():(e=t.wire)&&e.close&&e.close(),delete o.peers[t.id],t.wire=null})),t.on("bye",(function(t,n){this.to.next(t),(n=console.STAT)&&(n.peers=e.near),(n=t.url)&&setTimeout((function(){}),o.lack||9e3)})),t.on("hi",(function(n,r){if(this.to.next(n),(r=console.STAT)&&(r.peers=e.near),!o.super){var i=Object.keys(t.next||"");i.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(i,(function(r){var i=t.next[r];o.super||(i.ask||"")[""]?e.say({get:{"#":r}},n):setTimeout.each(Object.keys(i.ask||""),(function(o){o&&e.say({"##":String.hash((t.graph[r]||"")[o]),get:{"#":r,".":o}},n)}))}))}})),e}}catch(t){}}))(t,"./mesh"),t((function(e){var n=t("./index");n.Mesh=t("./mesh"),n.on("opt",(function(t){if(this.to.next(t),!t.once){var e=t.opt;if(!1!==e.WebSocket){var o=n.window||{},r=e.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;if(r){e.WebSocket=r;var i=e.mesh=e.mesh||n.Mesh(t);i.wire||e.wire,i.wire=e.wire=c,setTimeout((function(){!e.super&&t.on("out",{dam:"hi"})}),1);var a=1998,s=""+void 0!=typeof document&&document}}}function c(t){try{if(!t||!t.url)return o&&o(t);var n=t.url.replace(/^http/,"ws"),o=t.wire=new e.WebSocket(n);return o.onclose=function(){u(t),e.mesh.bye(t)},o.onerror=function(e){u(t)},o.onopen=function(){e.mesh.hi(t)},o.onmessage=function(n){n&&e.mesh.hear(n.data||n,t)},o}catch(n){e.mesh.bye(t)}}function u(t){clearTimeout(t.defer),e.peers[t.url]&&(s&&t.retry<=0||(t.retry=(t.retry||e.retry+1||60)-(-t.tried+(t.tried=+new Date)<4*a?1:0),t.defer=setTimeout((function e(){if(s&&s.hidden)return setTimeout(e,a);c(t)}),a)))}}))}))(t,"./websocket"),t((function(t){if("undefined"!=typeof Gun){var e;try{e=(Gun.window||function(){}).localStorage}catch(t){}e||(Gun.log("Warning: No localStorage exists to persist data to!"),e={setItem:function(t,e){this[t]=e},removeItem:function(t){delete this[t]},getItem:function(t){return this[t]}});var n=JSON.stringifyAsync||function(t,e,n,o){try{e(void 0,JSON.stringify(t,n,o))}catch(t){e(t)}};Gun.on("create",(function t(o){this.to.next(o);var r=o.opt;o.graph;var i,a,s,c,u=[];if(!1!==r.localStorage){r.prefix=r.file||"gun/";try{i=t[r.prefix]=t[r.prefix]||JSON.parse(s=e.getItem(r.prefix))||{}}catch(e){i=t[r.prefix]={}}s=(s||"").length,o.on("get",(function(t){this.to.next(t);var e,n,o,r=t.get;r&&(e=r["#"])&&((n=i[e]||void 0)&&(o=r["."])&&!Object.plain(o)&&(n=Gun.state.ify({},o,Gun.state.is(n,o),n[o],e)),Gun.on.get.ack(t,n))})),o.on("put",(function(t){this.to.next(t);var e=t.put,n=e["#"],r=e["."],l=t["#"],p=t.ok||"";i[n]=Gun.state.ify(i[n],r,e[">"],e[":"],n),c&&s>4999880?o.on("in",{"@":l,err:"localStorage max!"}):(t["@"]||t._.via&&!(Math.random()<p["@"]/p["/"])||u.push(l),a||(a=setTimeout(f,9+s/333)))}))}function f(){if(u.length||!((setTimeout.turn||"").s||"").length){var t=u;clearTimeout(a),a=!1,u=[],n(i,(function(n,a){try{!n&&e.setItem(r.prefix,a)}catch(t){n=c=t||"localStorage failure"}n&&(Gun.log(n+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),o.on("localStorage:error",{err:n,get:r.prefix,put:i})),s=a.length,setTimeout.each(t,(function(t){o.on("in",{"@":t,err:n,ok:0})}),0,99)}))}else setTimeout(f,99)}}))}}))(t,"./localStorage")}(),function(){if(""+$!=typeof Gun){var t=function(t){console.warn("Warning! Deprecated internal utility will break in next version:",t)},e=Gun;e.fn=e.fn||{is:function(e){return t("fn"),!!e&&"function"==typeof e}},e.bi=e.bi||{is:function(e){return t("bi"),e instanceof Boolean||"boolean"==typeof e}},e.num=e.num||{is:function(e){return t("num"),!o(e)&&(e-parseFloat(e)+1>=0||1/0===e||-1/0===e)}},e.text=e.text||{is:function(e){return t("text"),"string"==typeof e}},e.text.ify=e.text.ify||function(n){return t("text.ify"),e.text.is(n)?n:"undefined"!=typeof JSON?JSON.stringify(n):n&&n.toString?n.toString():n},e.text.random=e.text.random||function(e,n){t("text.random");var o="";for(e=e||24,n=n||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";e>0;)o+=n.charAt(Math.floor(Math.random()*n.length)),e--;return o},e.text.match=e.text.match||function(e,n){var o,r;return t("text.match"),"string"==typeof e&&("string"==typeof n&&(n={"=":n}),e===(o=(n=n||{})["="]||n["*"]||n[">"]||n["<"])||r===n["="]&&(o=n["*"]||n[">"]||n["<"],e.slice(0,(o||"").length)===o||r===n["*"]&&(r!==n[">"]&&r!==n["<"]?e>=n[">"]&&e<=n["<"]:r!==n[">"]&&e>=n[">"]||r!==n["<"]&&e<=n["<"])))},e.text.hash=e.text.hash||function(e,n){if(t("text.hash"),"string"==typeof e){if(n=n||0,!e.length)return n;for(var o=0,r=e.length;o<r;++o)n=(n<<5)-n+e.charCodeAt(o),n|=0;return n}},e.list=e.list||{is:function(e){return t("list"),e instanceof Array}},e.list.slit=e.list.slit||Array.prototype.slice,e.list.sort=e.list.sort||function(e){return t("list.sort"),function(t,n){return t&&n?(t=t[e])<(n=n[e])?-1:t>n?1:0:0}},e.list.map=e.list.map||function(e,n,o){return t("list.map"),a(e,n,o)},e.list.index=1,e.obj=e.boj||{is:function(e){return t("obj"),!!e&&(e instanceof Object&&e.constructor===Object||"Object"===Object.prototype.toString.call(e).match(/^\[object (\w+)\]$/)[1])}},e.obj.put=e.obj.put||function(e,n,o){return t("obj.put"),(e||{})[n]=o,e},e.obj.has=e.obj.has||function(e,n){return t("obj.has"),e&&Object.prototype.hasOwnProperty.call(e,n)},e.obj.del=e.obj.del||function(e,n){if(t("obj.del"),e)return e[n]=null,delete e[n],e},e.obj.as=e.obj.as||function(e,n,o,r){return t("obj.as"),e[n]=e[n]||(r===o?{}:o)},e.obj.ify=e.obj.ify||function(e){if(t("obj.ify"),r(e))return e;try{e=JSON.parse(e)}catch(t){e={}}return e},function(){function n(t,e){i(this,e)&&void 0!==this[e]||(this[e]=t)}e.obj.to=e.obj.to||function(e,o){return t("obj.to"),a(e,n,o=o||{}),o}}(),e.obj.copy=e.obj.copy||function(e){return t("obj.copy"),e?JSON.parse(JSON.stringify(e)):e},function(){function n(t,e){var n=this.n;if(!n||!(e===n||r(n)&&i(n,e)))return void 0!==e||void 0}e.obj.empty=e.obj.empty||function(e,o){return t("obj.empty"),!e||!a(e,n,{n:o})}}(),function(){function n(t,e){if(2===arguments.length)return n.r=n.r||{},void(n.r[t]=e);n.r=n.r||[],n.r.push(t)}var a,s=Object.keys;Object.keys=Object.keys||function(t){return a(t,(function(t,e,n){n(e)}))},e.obj.map=a=e.obj.map||function(a,c,u){t("obj.map");var f,l,p,h,d,g=0,y="function"==typeof c;if(n.r=f,s&&r(a)&&(h=s(a),d=!0),u=u||{},o(a)||h)for(l=(h||a).length;g<l;g++){var v=g+e.list.index;if(y){if((p=d?c.call(u,a[h[g]],h[g],n):c.call(u,a[g],v,n))!==f)return p}else if(c===a[d?h[g]:g])return h?h[g]:v}else for(g in a)if(y){if(i(a,g)&&(p=u?c.call(u,a[g],g,n):c(a[g],g,n))!==f)return p}else if(c===a[g])return g;return y?n.r:e.list.index?0:-1}}(),e.time=e.time||{},e.time.is=e.time.is||function(e){return t("time"),e?e instanceof Date:+(new Date).getTime()};var n=e.fn.is,o=e.list.is,r=(k=e.obj).is,i=k.has,a=k.map,s={is:function(e){return t("val.is"),e!==$&&(null===e||e!==1/0&&(!!(l(e)||u(e)||f(e))||s.link.is(e)||!1))}};s.link=s.rel={_:"#"},function(){function e(t,e){var n=this;return n.id?n.id=!1:e==c&&l(t)?void(n.id=t):n.id=!1}s.link.is=function(n){if(t("val.link.is"),n&&n[c]&&!n._&&r(n)){var o={};if(a(n,e,o),o.id)return o.id}return!1}}(),s.link.ify=function(e){return t("val.link.ify"),p({},c,e)},e.obj.has._=".";var c=s.link._,u=e.bi.is,f=e.num.is,l=e.text.is,p=(r=(k=e.obj).is,k.put);a=k.map,e.val=e.val||s;var h={_:"_",soul:function(e,n){return t("node.soul"),e&&e._&&e._[n||y]}};h.soul.ify=function(e,n){return t("node.soul.ify"),n="string"==typeof n?{soul:n}:n||{},(e=e||{})._=e._||{},e._[y]=n.soul||e._[y]||g(),e},h.soul._=s.link._,function(){function e(t,e){if(e!==h._)return!s.is(t)||void(this.cb&&this.cb.call(this.as,t,e,this.n,this.s))}h.is=function(n,o,i){var s;return t("node.is"),!!r(n)&&!!(s=h.soul(n))&&!a(n,e,{as:i,cb:o,s:s,n:n})}}(),function(){function e(t,e){var n,o=this.o;o.map?void 0===(n=o.map.call(this.as,t,""+e,o.node))?d(o.node,e):o.node&&(o.node[e]=n):s.is(t)&&(o.node[e]=t)}h.ify=function(n,o,r){return t("node.ify"),o?"string"==typeof o?o={soul:o}:"function"==typeof o&&(o={map:o}):o={},o.map&&(o.node=o.map.call(r,n,$,o.node||{})),(o.node=h.soul.ify(o.node||{},o))&&a(n,e,{o:o,as:r}),o.node}}(),r=(k=e.obj).is;var d=k.del,g=(a=k.map,e.text.random),y=h.soul._;e.node=e.node||h;var v=e.state;v.lex=function(){return t("state.lex"),v().toString(36).replace(".","")},v.to=function(e,n,o){t("state.to");var i=(e||{})[n];return r(i)&&(i=m(i)),v.ify(o,n,v.is(e,n),i,h.soul(e))},function(){function e(t,e){b!==e&&v.ify(this.o,e,this.s)}v.map=function(o,s,c){var u;t("state.map");var l=r(l=o||s)?l:null;return o=n(o=o||s)?o:null,l&&!o?(s=f(s)?s:v(),l[b]=l[b]||{},a(l,e,{o:l,s:s}),l):(c=c||r(s)?s:u,s=f(s)?s:v(),function(t,n,r,a){if(!o)return e.call({o:r,s:s},t,n),t;o.call(c||this||{},t,n,r,a),i(r,n)&&u===r[n]||e.call({o:r,s:s},t,n)})}}(),(k=e.obj).as,i=k.has,r=k.is,a=k.map;var m=k.copy,b=(f=e.num.is,n=e.fn.is,h._),w={};!function(){function e(t,e){if(!t||e!==h.soul(t)||!h.is(t,this.fn,this.as))return!0;this.cb&&(n.n=t,n.as=this.as,this.cb.call(n.as,t,e,n))}function n(t){t&&h.is(n.n,t,n.as)}w.is=function(n,o,i,s){return t("graph.is"),!(!n||!r(n)||x(n)||a(n,e,{cb:o,fn:i,as:s}))}}(),function(){function n(t,e){var n;return(n=function(t,e){for(var n,o=t.seen,r=o.length;r--;)if(n=o[r],e.obj===n.obj)return n;o.push(e)}(t,e))?n:(e.env=t,e.soul=a,h.ify(e.obj,o,e)&&(e.link=e.link||s.link.ify(h.soul(e.node)),e.obj!==t.shell&&(t.graph[s.link.is(e.link)]=e.node)),e)}function o(t,e,o){var r,a,u=this,f=u.env;if(h._===e&&i(t,s.link._))return o._;if(r=c(t,e,o,u,f)){if(e||(u.node=u.node||o||{},i(t,h._)&&h.soul(t)&&(u.node._=m(t._)),u.node=h.soul.ify(u.node,s.link.is(u.link)),u.link=u.link||s.link.ify(h.soul(u.node))),(a=f.map)&&(a.call(f.as||{},t,e,o,u),i(o,e))){if(t=o[e],$===t)return void d(o,e);if(!(r=c(t,e,o,u,f)))return}if(!e)return u.node;if(!0===r)return t;if((a=n(f,{obj:t,path:u.path.concat(e)})).node)return a.link}}function a(t){var e=this,n=s.link.is(e.link),o=e.env.graph;e.link=e.link||s.link.ify(t),e.link[s.link._]=t,e.node&&e.node[h._]&&(e.node[h._][s.link._]=t),i(o,n)&&(o[t]=o[n],d(o,n))}function c(t,n,o,i,a){var u;return!!s.is(t)||(r(t)?1:(u=a.invalid)?c(t=u.call(a.as||{},t,n,o),n,o,i,a):(a.err="Invalid value at '"+i.path.concat(n).join(".")+"'!",void(e.list.is(t)&&(a.err+=" Use `.set(item)` instead of an Array."))))}w.ify=function(e,o,r){t("graph.ify");var i={path:[],obj:e};return o?"string"==typeof o?o={soul:o}:"function"==typeof o&&(o.map=o):o={},"string"==typeof r&&(o.soul=o.soul||r,r=$),o.soul&&(i.link=s.link.ify(o.soul)),o.shell=(r||{}).shell,o.graph=o.graph||{},o.seen=o.seen||[],o.as=o.as||r,n(o,i),o.root=i.node,o.graph}}(),w.node=function(e){t("graph.node");var n=h.soul(e);if(n)return p({},n,e)},function(){function e(t,e){var n,o;if(h._!==e)(n=s.link.is(t))?(o=this.opt.seen[n])?this.obj[e]=o:this.obj[e]=this.opt.seen[n]=w.to(this.graph,n,this.opt):this.obj[e]=t;else{if(x(t,s.link._))return;this.obj[e]=m(t)}}w.to=function(n,o,r){if(t("graph.to"),n){var i={};return r=r||{seen:{}},a(n[o],e,{obj:i,graph:n,opt:r}),i}}}(),n=e.fn.is,r=(k=e.obj).is,d=k.del,i=k.has;var k,$,x=k.empty;p=k.put,a=k.map,m=k.copy,e.graph=e.graph||w}}();var ut=it(ct.exports),ft={exports:{}};!function(t){!function(){function e(t,n){return n?at(t):t.slice?e[o(t)]:function(n,r){t(n={exports:{}}),e[o(r)]=n.exports};function o(t){return t.split("/").slice(-1).toString().replace(".js","")}}var n=t;e((function(t){"undefined"!=typeof self&&(t.window=self),"undefined"!=typeof window&&(t.window=window);var e=(t.window||t).SEA||{};(e.window=t.window)&&(e.window.SEA=e);try{undefined+""!=typeof n&&(n.exports=e)}catch(t){}t.exports=e}))(e,"./root"),e((function(t){var n=e("./root");try{n.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch(t){}}))(e,"./https"),e((function(t){var n;if(n+""==typeof btoa){if(n+""==typeof Buffer)try{rt.Buffer=e("buffer",1).Buffer}catch(t){console.log("Please `npm install buffer` or add it to your package.json !")}rt.btoa=function(t){return Buffer.from(t,"binary").toString("base64")},rt.atob=function(t){return Buffer.from(t,"base64").toString("binary")}}}))(e,"./base64"),e((function(t){function n(){}e("./base64"),Object.assign(n,{from:Array.from}),n.prototype=Object.create(Array.prototype),n.prototype.toString=function(t,e,n){t=t||"utf8",e=e||0;const o=this.length;if("hex"===t){const t=new Uint8Array(this);return[...Array((n&&n+1||o)-e).keys()].map((n=>t[n+e].toString(16).padStart(2,"0"))).join("")}return"utf8"===t?Array.from({length:(n||o)-e},((t,n)=>String.fromCharCode(this[n+e]))).join(""):"base64"===t?btoa(this):void 0},t.exports=n}))(e,"./array"),e((function(t){e("./base64");var n=e("./array");function o(...t){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),o.from(...t)}o.prototype=Object.create(Array.prototype),Object.assign(o,{from(){if(!Object.keys(arguments).length||null==arguments[0])throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const t=arguments[0];let e;if("string"==typeof t){const o=arguments[1]||"utf8";if("hex"===o){const o=t.match(/([\da-fA-F]{2})/g).map((t=>parseInt(t,16)));if(!o||!o.length)throw new TypeError("Invalid first argument for type 'hex'.");e=n.from(o)}else if("utf8"===o||"binary"===o){const o=t.length,r=new Uint16Array(o);Array.from({length:o},((e,n)=>r[n]=t.charCodeAt(n))),e=n.from(r)}else if("base64"===o){const o=atob(t),r=o.length,i=new Uint8Array(r);Array.from({length:r},((t,e)=>i[e]=o.charCodeAt(e))),e=n.from(i)}else"binary"===o?e=n.from(t):console.info("SafeBuffer.from unknown encoding: "+o);return e}t.byteLength;if(t.byteLength?t.byteLength:t.length){let e;return t instanceof ArrayBuffer&&(e=new Uint8Array(t)),n.from(e||t)}},alloc:(t,e=0)=>n.from(new Uint8Array(Array.from({length:t},(()=>e)))),allocUnsafe:t=>n.from(new Uint8Array(Array.from({length:t}))),concat(t){if(!Array.isArray(t))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return n.from(t.reduce(((t,e)=>t.concat(Array.from(e))),[]))}}),o.prototype.from=o.from,o.prototype.toString=n.prototype.toString,t.exports=o}))(e,"./buffer"),e((function(t){const o=e("./root"),r={Buffer:e("./buffer")};var i={};if(JSON.parseAsync=JSON.parseAsync||function(t,e,n){try{e(undefined,JSON.parse(t,n))}catch(t){e(t)}},JSON.stringifyAsync=JSON.stringifyAsync||function(t,e,n,o){try{e(undefined,JSON.stringify(t,n,o))}catch(t){e(t)}},r.parse=function(t,e){return new Promise((function(n,o){JSON.parseAsync(t,(function(t,e){t?o(t):n(e)}),e)}))},r.stringify=function(t,e,n){return new Promise((function(o,r){JSON.stringifyAsync(t,(function(t,e){t?r(t):o(e)}),e,n)}))},o.window&&(r.crypto=o.window.crypto||o.window.msCrypto,r.subtle=(r.crypto||i).subtle||(r.crypto||i).webkitSubtle,r.TextEncoder=o.window.TextEncoder,r.TextDecoder=o.window.TextDecoder,r.random=t=>r.Buffer.from(r.crypto.getRandomValues(new Uint8Array(r.Buffer.alloc(t))))),!r.TextDecoder){const{TextEncoder:t,TextDecoder:o}=e((undefined+""==typeof n?".":"")+"./lib/text-encoding",1);r.TextDecoder=o,r.TextEncoder=t}if(!r.crypto)try{var a=e("crypto",1);Object.assign(r,{crypto:a,random:t=>r.Buffer.from(a.randomBytes(t))});const{Crypto:t}=e("@peculiar/webcrypto",1);r.ossl=r.subtle=new t({directory:"ossl"}).subtle}catch(t){console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}t.exports=r}))(e,"./shim"),e((function(t){var n=e("./root"),o=e("./shim"),r={pbkdf2:{hash:{name:"SHA-256"},iter:1e5,ks:64},ecdsa:{pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},ecdh:{name:"ECDH",namedCurve:"P-256"},jwk:function(t,e){var n={kty:"EC",crv:"P-256",x:(t=t.split("."))[0],y:t[1],ext:!0};return n.key_ops=e?["sign"]:["verify"],e&&(n.d=e),n},keyToJwk:function(t){return{kty:"oct",k:t.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},recall:{validity:43200,hook:function(t){return t}},check:function(t){return"string"==typeof t&&"SEA{"===t.slice(0,4)},parse:async function(t){try{var e="string"==typeof t;return e&&"SEA{"===t.slice(0,4)&&(t=t.slice(3)),e?await o.parse(t):t}catch(t){}return t}};n.opt=r,t.exports=r}))(e,"./settings"),e((function(t){var n=e("./shim");t.exports=async function(t,e){var o="string"==typeof t?t:await n.stringify(t),r=await n.subtle.digest({name:e||"SHA-256"},(new n.TextEncoder).encode(o));return n.Buffer.from(r)}}))(e,"./sha256"),e((function(t){const n=e("./shim"),o=n.subtle,r=n.ossl?n.ossl:o;t.exports=t=>r.digest({name:"SHA-1"},new ArrayBuffer(t))}))(e,"./sha1"),e((function(t){var n=e("./root"),o=e("./shim"),r=e("./settings"),i=e("./sha256");n.work=n.work||(async(t,e,a,s)=>{try{var c=(e||{}).epub||e;if(s=s||{},c instanceof Function&&(a=c,c=undefined),t="string"==typeof t?t:await o.stringify(t),"sha"===(s.name||"").toLowerCase().slice(0,3)){var u=o.Buffer.from(await i(t,s.name),"binary").toString(s.encode||"base64");if(a)try{a(u)}catch(t){console.log(t)}return u}c=c||o.random(9);var f=await(o.ossl||o.subtle).importKey("raw",(new o.TextEncoder).encode(t),{name:s.name||"PBKDF2"},!1,["deriveBits"]),l=await(o.ossl||o.subtle).deriveBits({name:s.name||"PBKDF2",iterations:s.iterations||r.pbkdf2.iter,salt:(new o.TextEncoder).encode(s.salt||c),hash:s.hash||r.pbkdf2.hash},f,s.length||8*r.pbkdf2.ks);t=o.random(t.length);var p=o.Buffer.from(l,"binary").toString(s.encode||"base64");if(a)try{a(p)}catch(t){console.log(t)}return p}catch(t){if(console.log(t),n.err=t,n.throw)throw t;return void(a&&a())}}),t.exports=n.work}))(e,"./work"),e((function(t){var n=e("./root"),o=e("./shim");e("./settings"),n.name=n.name||(async(t,e)=>{try{if(t)try{t()}catch(t){console.log(t)}return}catch(e){if(console.log(e),n.err=e,n.throw)throw e;return void(t&&t())}}),n.pair=n.pair||(async(t,e)=>{try{var r=o.ossl||o.subtle,i=await o.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then((async t=>{var e={};e.priv=(await o.subtle.exportKey("jwk",t.privateKey)).d;var n=await o.subtle.exportKey("jwk",t.publicKey);return e.pub=n.x+"."+n.y,e}));try{var a=await r.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then((async t=>{var e={};e.epriv=(await r.exportKey("jwk",t.privateKey)).d;var n=await r.exportKey("jwk",t.publicKey);return e.epub=n.x+"."+n.y,e}))}catch(t){if(n.window)throw t;if("Error: ECDH is not a supported algorithm"!=t)throw t;console.log("Ignoring ECDH...")}a=a||{};var s={pub:i.pub,priv:i.priv,epub:a.epub,epriv:a.epriv};if(t)try{t(s)}catch(t){console.log(t)}return s}catch(e){if(console.log(e),n.err=e,n.throw)throw e;return void(t&&t())}}),t.exports=n.pair}))(e,"./pair"),e((function(t){var n,o=e("./root"),r=e("./shim"),i=e("./settings"),a=e("./sha256");o.sign=o.sign||(async(t,e,s,c)=>{try{if(c=c||{},!(e||c).priv){if(!o.I)throw"No signing key.";e=await o.I(null,{what:t,how:"sign",why:c.why})}if(n===t)throw"`undefined` not allowed.";var u=await i.parse(t),f=c.check=c.check||u;if(o.verify&&(o.opt.check(f)||f&&f.s&&f.m)&&n!==await o.verify(f,e)){var l=await i.parse(f);if(c.raw||(l="SEA"+await r.stringify(l)),s)try{s(l)}catch(t){console.log(t)}return l}var p=e.pub,h=e.priv,d=i.jwk(p,h),g=await a(u),y=await(r.ossl||r.subtle).importKey("jwk",d,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then((t=>(r.ossl||r.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},t,new Uint8Array(g))));l={m:u,s:r.Buffer.from(y,"binary").toString(c.encode||"base64")};if(c.raw||(l="SEA"+await r.stringify(l)),s)try{s(l)}catch(t){console.log(t)}return l}catch(t){if(console.log(t),o.err=t,o.throw)throw t;return void(s&&s())}}),t.exports=o.sign}))(e,"./sign"),e((function(t){var n,o=e("./root"),r=e("./shim"),i=e("./settings"),a=e("./sha256");o.verify=o.verify||(async(t,e,s,c)=>{try{var u=await i.parse(t);if(!1===e){var f=await i.parse(u.m);if(s)try{s(f)}catch(t){console.log(t)}return f}c=c||{};var l,p,h,d=e.pub||e,g=o.opt.slow_leak?await o.opt.slow_leak(d):await(r.ossl||r.subtle).importKey("jwk",i.jwk(d),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),y=await a(u.m);try{if(l=r.Buffer.from(u.s,c.encode||"base64"),p=new Uint8Array(l),!(h=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},g,p,new Uint8Array(y))))throw"Signature did not match."}catch(n){if(o.opt.fallback)return await o.opt.fall_verify(t,e,s,c)}var v=h?await i.parse(u.m):n;if(s)try{s(v)}catch(t){console.log(t)}return v}catch(t){if(console.log(t),o.err=t,o.throw)throw t;return void(s&&s())}}),t.exports=o.verify;var s={};o.opt.slow_leak=t=>{if(s[t])return s[t];var e=i.jwk(t);return s[t]=(r.ossl||r.subtle).importKey("jwk",e,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),s[t]};var c=o.opt;o.opt.fall_verify=async function(t,e,s,u,f){if(f===o.opt.fallback)throw"Signature did not match";f=f||1;var l=t||"";t=o.opt.unpack(t)||t;var p,h,d,g=await i.parse(t),y=e.pub||e,v=await o.opt.slow_leak(y),m=f<=o.opt.fallback?r.Buffer.from(await r.subtle.digest({name:"SHA-256"},(new r.TextEncoder).encode(await i.parse(g.m)))):await a(g.m);try{if(p=r.Buffer.from(g.s,u.encode||"base64"),h=new Uint8Array(p),!(d=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},v,h,new Uint8Array(m))))throw"Signature did not match."}catch(t){try{p=r.Buffer.from(g.s,"utf8"),h=new Uint8Array(p),d=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},v,h,new Uint8Array(m))}catch(t){if(!d)throw"Signature did not match."}}var b=d?await i.parse(g.m):n;if(c.fall_soul=l["#"],c.fall_key=l["."],c.fall_val=t,c.fall_state=l[">"],s)try{s(b)}catch(t){console.log(t)}return b},o.opt.fallback=2}))(e,"./verify"),e((function(t){var n=e("./shim"),o=e("./settings"),r=e("./sha256");t.exports=async(t,e,i)=>{const a=t+(e||n.random(8)).toString("utf8"),s=n.Buffer.from(await r(a),"binary"),c=o.keyToJwk(s);return await n.subtle.importKey("jwk",c,{name:"AES-GCM"},!1,["encrypt","decrypt"])}}))(e,"./aeskey"),e((function(t){var n=e("./root"),o=e("./shim");e("./settings");var r=e("./aeskey");n.encrypt=n.encrypt||(async(t,e,i,a)=>{try{a=a||{};var s=(e||a).epriv||e;if(undefined===t)throw"`undefined` not allowed.";if(!s){if(!n.I)throw"No encryption key.";s=(e=await n.I(null,{what:t,how:"encrypt",why:a.why})).epriv||e}var c="string"==typeof t?t:await o.stringify(t),u={s:o.random(9),iv:o.random(15)},f=await r(s,u.s,a).then((t=>o.subtle.encrypt({name:a.name||"AES-GCM",iv:new Uint8Array(u.iv)},t,(new o.TextEncoder).encode(c)))),l={ct:o.Buffer.from(f,"binary").toString(a.encode||"base64"),iv:u.iv.toString(a.encode||"base64"),s:u.s.toString(a.encode||"base64")};if(a.raw||(l="SEA"+await o.stringify(l)),i)try{i(l)}catch(t){console.log(t)}return l}catch(t){if(console.log(t),n.err=t,n.throw)throw t;return void(i&&i())}}),t.exports=n.encrypt}))(e,"./encrypt"),e((function(t){var n=e("./root"),o=e("./shim"),r=e("./settings"),i=e("./aeskey");n.decrypt=n.decrypt||(async(t,e,a,s)=>{try{s=s||{};var c=(e||s).epriv||e;if(!c){if(!n.I)throw"No decryption key.";c=(e=await n.I(null,{what:t,how:"decrypt",why:s.why})).epriv||e}var u,f,l,p=await r.parse(t);try{u=o.Buffer.from(p.s,s.encode||"base64"),f=o.Buffer.from(p.iv,s.encode||"base64"),l=o.Buffer.from(p.ct,s.encode||"base64");var h=await i(c,u,s).then((t=>o.subtle.decrypt({name:s.name||"AES-GCM",iv:new Uint8Array(f),tagLength:128},t,new Uint8Array(l))))}catch(o){if("utf8"===s.encode)throw"Could not decrypt";if(n.opt.fallback)return s.encode="utf8",await n.decrypt(t,e,a,s)}var d=await r.parse(new o.TextDecoder("utf8").decode(h));if(a)try{a(d)}catch(t){console.log(t)}return d}catch(t){if(console.log(t),n.err=t,n.throw)throw t;return void(a&&a())}}),t.exports=n.decrypt}))(e,"./decrypt"),e((function(t){var n=e("./root"),o=e("./shim");e("./settings"),n.secret=n.secret||(async(t,e,i,a)=>{try{if(a=a||{},!e||!e.epriv||!e.epub){if(!n.I)throw"No secret mix.";e=await n.I(null,{what:t,how:"secret",why:a.why})}var s=t.epub||t,c=e.epub,u=e.epriv,f=o.ossl||o.subtle,l=r(s),p=Object.assign({public:await f.importKey(...l,!0,[])},{name:"ECDH",namedCurve:"P-256"}),h=r(c,u),d=await f.importKey(...h,!1,["deriveBits"]).then((async t=>{var e=await f.deriveBits(p,t,256),n=new Uint8Array(e),o=await f.importKey("raw",n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return f.exportKey("jwk",o).then((({k:t})=>t))}));if(i)try{i(d)}catch(t){console.log(t)}return d}catch(t){if(console.log(t),n.err=t,n.throw)throw t;return void(i&&i())}});var r=(t,e)=>{var[n,o]=t.split("."),r=e?{d:e}:{};return["jwk",Object.assign(r,{x:n,y:o,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};t.exports=n.secret}))(e,"./secret"),e((function(t){var n=e("./root");n.certify=n.certify||(async(t,e={},o,r,i={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),t=(()=>{var e=[];if(t){if(("string"==typeof t||Array.isArray(t))&&t.indexOf("*")>-1)return"*";if("string"==typeof t)return t;if(Array.isArray(t)){if(1===t.length&&t[0])return"object"==typeof t[0]&&t[0].pub?t[0].pub:"string"==typeof t[0]?t[0]:null;t.map((t=>{"string"==typeof t?e.push(t):"object"==typeof t&&t.pub&&e.push(t.pub)}))}return"object"==typeof t&&t.pub?t.pub:e.length>0?e:null}})(),!t)return console.log("No certificant found.");const s=!i.expiry||"number"!=typeof i.expiry&&"string"!=typeof i.expiry?null:parseFloat(i.expiry),c=(e||{}).read?e.read:null,u=(e||{}).write?e.write:"string"==typeof e||Array.isArray(e)||e["+"]||e["#"]||e["."]||e["="]||e["*"]||e[">"]||e["<"]?e:null,f=(i||{}).block||(i||{}).blacklist||(i||{}).ban||{},l=f.read&&("string"==typeof f.read||(f.read||{})["#"])?f.read:null,p="string"==typeof f?f:f.write&&("string"==typeof f.write||f.write["#"])?f.write:null;if(!c&&!u)return console.log("No policy found.");const h=JSON.stringify({c:t,...s?{e:s}:{},...c?{r:c}:{},...u?{w:u}:{},...l?{rb:l}:{},...p?{wb:p}:{}});var a=await n.sign(h,o,null,{raw:1});if(i.raw||(a="SEA"+JSON.stringify(a)),r)try{r(a)}catch(t){console.log(t)}return a}catch(t){if(n.err=t,n.throw)throw t;return void(r&&r())}}),t.exports=n.certify}))(e,"./certify"),e((function(t){var n=e("./shim"),o=e("./root");o.work=e("./work"),o.sign=e("./sign"),o.verify=e("./verify"),o.encrypt=e("./encrypt"),o.decrypt=e("./decrypt"),o.certify=e("./certify"),o.random=o.random||n.random,o.Buffer=o.Buffer||e("./buffer"),o.keyid=o.keyid||(async t=>{try{const e=n.Buffer.concat(t.replace(/-/g,"+").replace(/_/g,"/").split(".").map((t=>n.Buffer.from(t,"base64")))),o=n.Buffer.concat([n.Buffer.from([153,e.length/256,e.length%256]),e]),r=await sha1hash(o),i=n.Buffer.from(r,"binary");return i.toString("hex",i.length-8)}catch(t){throw console.log(t),t}}),((o.window||{}).GUN||{}).SEA=o,t.exports=o}))(e,"./sea"),e((function(t){var o,r=e("./sea");function i(t){this._={$:this}}function a(){return o.state().toString(36).replace(".","")}o=r.window?r.window.GUN||{chain:{}}:e((undefined+""==typeof n?".":"")+"./gun",1),r.GUN=o,i.prototype=function(){function t(){}return t.prototype=o.chain,new t}(),i.prototype.constructor=i,o.chain.user=function(t){var e,n=this.back(-1);if(t)return t=r.opt.pub((t._||"")["#"])||t,n.get("~"+t);if(e=n.back("user"))return e;var o=n=n._,s=o.opt.uuid||a;return(o=(e=o.user=this.chain(new i))._).opt={},o.opt.uuid=function(t){var e=s(),o=n.user;return o&&(o=o.is)&&(o=o.pub)?(e="~"+o+"/"+e,t&&t.call&&t(null,e),e):e},e},o.User=i,i.GUN=o,i.SEA=o.SEA=r,t.exports=i}))(e,"./user"),e((function(t){var o;(""+o!=typeof GUN?GUN||{chain:{}}:e((""+o==typeof n?".":"")+"./gun",1)).chain.then=function(t,e){var n=this,o=new Promise((function(t,o){n.once(t,e)}));return t?o.then(t):o}}))(e,"./then"),e((function(t){var n=e("./user"),o=n.SEA,r=n.GUN,i=function(){};n.prototype.create=function(...t){var e,n="object"==typeof t[0]&&(t[0].pub||t[0].epub)?t[0]:"object"==typeof t[1]&&(t[1].pub||t[1].epub)?t[1]:null,a=n&&(n.pub||n.epub)?n.pub:"string"==typeof t[0]?t[0]:null,s=n&&(n.pub||n.epub)?n:a&&"string"==typeof t[1]?t[1]:null,c=t.filter((t=>"function"==typeof t))[0]||null,u=t&&t.length>1&&"object"==typeof t[t.length-1]?t[t.length-1]:{},f=this,l=f._,p=f.back(-1);if((c=c||i,!1!==(u=u||{}).check)&&(a||(e="No user."),(s||"").length<8&&(e="Password too short!"),e))return c({err:r.log(e)}),f;if(l.ing)return(c||i)({err:r.log("User is already being created or authenticated!"),wait:!0}),f;l.ing=!0;var h={a:function(t){if(h.pubs=t,t&&!u.already){var e={err:r.log("User already created!")};return l.ing=!1,(c||i)(e),void f.leave()}h.salt=String.random(64),o.work(s,h.salt,h.b)},b:function(t){h.proof=t,n?h.c(n):o.pair(h.c)},c:function(t){var e;h.pair=t||{},(e=l.root.user)&&(e._.sea=t,e.is={pub:t.pub,epub:t.epub,alias:a}),h.data={pub:t.pub},h.d()},d:function(){h.data.alias=a,h.e()},e:function(){h.data.epub=h.pair.epub,o.encrypt({priv:h.pair.priv,epriv:h.pair.epriv},h.proof,h.f,{raw:1})},f:function(t){h.data.auth=JSON.stringify({ek:t,s:h.salt}),h.g(h.data.auth)},g:function(t){var e;h.data.auth=h.data.auth||t,p.get(e="~"+h.pair.pub).put(h.data).on(h.h);var n={};n[e]={"#":e},p.get("~@"+a).put(n).get(e).on(h.i)},h:function(t,e,n,o){o.off(),h.h.ok=1,h.i()},i:function(t,e,o,r){r&&(h.i.ok=1,r.off()),h.h.ok&&h.i.ok&&(l.ing=!1,c({ok:0,pub:h.pair.pub}),i===c&&(n?f.auth(n):f.auth(a,s)))}};return p.get("~@"+a).once(h.a),f},n.prototype.leave=function(t,e){var n=this.back(-1)._.user;if(n&&(delete n.is,delete n._.is,delete n._.sea),o.window)try{var r={};delete(r=o.window.sessionStorage).recall,delete r.pair}catch(t){}return this}}))(e,"./create"),e((function(t){var n=e("./user"),o=n.SEA,r=n.GUN,i=function(){};function a(t){if("string"!=typeof t)return t;try{t=JSON.parse(t)}catch(e){t={}}return t}n.prototype.auth=function(...t){var e="object"==typeof t[0]&&(t[0].pub||t[0].epub)?t[0]:"object"==typeof t[1]&&(t[1].pub||t[1].epub)?t[1]:null,n=e||"string"!=typeof t[0]?null:t[0],s=!n&&(!e||e.priv&&e.epriv)||"string"!=typeof t[1]?null:t[1],c=t.filter((t=>"function"==typeof t))[0]||null,u=t&&t.length>1&&"object"==typeof t[t.length-1]?t[t.length-1]:{},f=this,l=f._,p=f.back(-1);if(l.ing)return(c||i)({err:r.log("User is already being created or authenticated!"),wait:!0}),f;l.ing=!0;var h,d={},g=9;return d.a=function(t){if(!t)return d.b();if(!t.pub){var e=[];return Object.keys(t).forEach((function(n){"_"!=n&&e.push(t[n])})),d.b(e)}if(d.name)return d.f(t);d.c((d.data=t).auth)},d.b=function(t){var e=(d.list=(d.list||[]).concat(t||[])).shift();if(h===e)return d.name?d.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer."):n&&g--?void p.get("~@"+n).once(d.a):d.err("Wrong user or password.");p.get(e).once(d.a)},d.c=function(t){return h===t?d.b():"string"==typeof t?d.c(a(t)):void o.work(s,(d.auth=t).s,d.d,d.enc)},d.d=function(t){o.decrypt(d.auth.ek,t,d.e,d.enc)},d.e=function(t){if(h===t)return d.enc?(d.enc=null,d.b()):(d.enc={encode:"utf8"},d.c(d.auth));d.half=t,d.f(d.data)},d.f=function(t){var e=d.half||{},n=d.data||{};d.g(d.lol={pub:t.pub||n.pub,epub:t.epub||n.epub,priv:t.priv||e.priv,epriv:t.epriv||e.epriv})},d.g=function(t){if(!t||!t.pub||!t.epub)return d.b();d.pair=t;var e=p._.user,g=e._;g.tag;var y=g.opt;(g=e._=p.get("~"+t.pub)._).opt=y,e.is={pub:t.pub,epub:t.epub,alias:n||t.pub},g.sea=d.pair,l.ing=!1;try{s&&h==(a(l.root.graph["~"+t.pub].auth)||"")[":"]&&(u.shuffle=u.change=s)}catch(t){}if(u.change?d.z():(c||i)(g),o.window&&(f.back("user")._.opt||u).remember)try{var v={};(v=o.window.sessionStorage).recall=!0,v.pair=JSON.stringify(t)}catch(t){}try{p._.tag.auth?p._.on("auth",g):setTimeout((function(){p._.on("auth",g)}),1)}catch(t){r.log("Your 'auth' callback crashed with:",t)}},d.h=function(t){return t?((n=t.alias)||(n=t.alias="~"+e.pub),t.auth?(e=null,void d.c((d.data=t).auth)):d.g(e)):d.b()},d.z=function(){d.salt=String.random(64),o.work(u.change,d.salt,d.y)},d.y=function(t){o.encrypt({priv:d.pair.priv,epriv:d.pair.epriv},t,d.x,{raw:1})},d.x=function(t){d.w(JSON.stringify({ek:t,s:d.salt}))},d.w=function(t){if(u.shuffle){console.log("migrate core account from UTF8 & shuffle");var e={};Object.keys(d.data).forEach((function(t){e[t]=d.data[t]})),delete e._,e.auth=t,p.get("~"+d.pair.pub).put(e)}p.get("~"+d.pair.pub).get("auth").put(t,c||i)},d.err=function(t){var e={err:r.log(t||"User cannot be found!")};l.ing=!1,(c||i)(e)},d.plugin=function(t){if(!(d.name=t))return d.err();var e=[t];"~"!==t[0]&&(e[1]="~"+t,e[2]="~@"+t),d.b(e)},e?e.priv&&e.epriv?d.g(e):p.get("~"+e.pub).once(d.h):n?p.get("~@"+n).once(d.a):n||s||o.name(d.plugin),f}}))(e,"./auth"),e((function(t){var n=e("./user"),o=n.SEA;n.GUN,n.prototype.recall=function(t,e){var n=this,r=n.back(-1);if((t=t||{})&&t.sessionStorage){if(o.window)try{var i;(i=o.window.sessionStorage)&&(r._.opt.remember=!0,(n.back("user")._.opt||t).remember=!0,(i.recall||i.pair)&&r.user().auth(JSON.parse(i.pair),e))}catch(t){}return n}return n}}))(e,"./recall"),e((function(t){var n=e("./user"),o=n.SEA,r=n.GUN,i=function(){};n.prototype.pair=function(){var t,e=this;try{t=new Proxy({DANGER:"☠"},{get:function(t,n,o){if(e.is&&(e._||"").sea)return e._.sea[n]}})}catch(t){}return t},n.prototype.delete=async function(t,e,n){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var o=this;o.back(-1);var a=o.back("user");try{a.auth(t,e,(function(t){(a.is||{}).pub;a.map().once((function(){this.put(null)})),a.leave(),(n||i)({ok:0})}))}catch(t){r.log("User.delete failed! Error:",t)}return o},n.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const t=this.back(-1);try{return await authRecall(t),t._.user._}catch(t){const e="No session!";throw r.log(e),{err:e}}},n.prototype.trust=async function(t){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),r.is(t)&&t.get("pub").get(((t,e)=>{console.log(t,e)})),t.get("trust").get(path).put(theirPubkey)},n.prototype.grant=function(t,e){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var n=this,r=n.back(-1).user(),i=r._.sea,a="";return n.back((function(t){t.is||(a+=t.get||"")})),async function(){var n,s=await r.get("grant").get(i.pub).get(a).then();(s=await o.decrypt(s,i))||(s=o.random(16).toString(),n=await o.encrypt(s,i),r.get("grant").get(i.pub).get(a).put(n));var c=t.get("pub").then(),u=t.get("epub").then();c=await c,u=await u;var f=await o.secret(u,i);n=await o.encrypt(s,f),r.get("grant").get(c).get(a).put(n,e)}(),n},n.prototype.secret=function(t,e){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var n=this,r=n.back(-1).user(),i=r.pair(),a="";return n.back((function(t){t.is||(a+=t.get||"")})),async function(){var s,c=await r.get("trust").get(i.pub).get(a).then();(c=await o.decrypt(c,i))||(c=o.random(16).toString(),s=await o.encrypt(c,i),r.get("trust").get(i.pub).get(a).put(s)),s=await o.encrypt(t,c),n.put(s,e)}(),n},t.exports=n}))(e,"./share"),e((function(t){var o,r=e("./sea"),i=e("./settings"),a=(r.window||"").GUN||e((""+o==typeof n?".":"")+"./gun",1);function s(t){var e,n=this,o=n.as,i=t.put,c=i["#"],u=i["."],f=i[":"],l=i[">"],p=t["#"];if(c&&u)if((t._||"").faith&&(o.opt||"").faith&&"function"==typeof t._)r.opt.pack(i,(function(e){r.verify(e,!1,(function(e){i["="]=r.opt.unpack(e),n.to.next(t)}))}));else{var h=function(e){o.on("in",{"@":p,err:t.err=e})};(t._||"").DBG&&((t._||"").DBG.c=+new Date),0<=c.indexOf("<?")&&(e=parseFloat(c.split("<?")[1]||""))&&l<a.state()-1e3*e?(e=t._)&&e.stun&&e.stun--:"~@"!==c?"~@"!==c.slice(0,2)?(e=r.opt.pub(c))?s.pub(n,t,f,u,c,o,h,o.user||"",e):0<=c.indexOf("#")?s.hash(n,t,f,u,c,o,h):s.any(n,t,f,u,c,o,h,o.user||""):s.pubs(n,t,f,u,c,o,h):s.alias(n,t,f,u,c,o,h)}}a.on("opt",(function(t){t.sea||(t.sea={own:{}},t.on("put",s,t)),this.to.next(t)})),s.hash=function(t,e,n,o,i,a,s){r.work(n,null,(function(n){return n&&n===o.split("#").slice(-1)[0]||n&&n===function(t){let e="";for(let n=0;n<t.length;n++)e+=n-1&1?"":String.fromCharCode(parseInt(t.substring(n-1,n+1),16));return btoa(e)}(o.split("#").slice(-1)[0])?t.to.next(e):void s("Data hash not same as hash!")}),{name:"SHA-256"})},s.alias=function(t,e,n,o,r,i,a){return n?"~@"+o===u(n)?t.to.next(e):void a("Alias not same!"):a("Data must exist!")},s.pubs=function(t,e,n,o,r,i,a){return n?o===u(n)?t.to.next(e):void a("Alias not same!"):a("Alias must exist!")},s.pub=async function(t,e,n,s,c,f,l,p,h){var d;const g=await i.parse(n)||{},y=(n,i,u)=>{if(n.m&&n.s&&i&&h)return r.verify(n,h,(n=>{if(o!==n&&o!==n.e&&e.put[">"]&&e.put[">"]>parseFloat(n.e))return l("Certificate expired.");if(o!==n&&n.c&&n.w&&(n.c===i||n.c.indexOf("*")>-1)){let e=c.indexOf("/")>-1?c.replace(c.substring(0,c.indexOf("/")+1),""):"";String.match=String.match||a.text.match;const o=Array.isArray(n.w)?n.w:"object"==typeof n.w||"string"==typeof n.w?[n.w]:[];for(const a of o)if(String.match(e,a["#"])&&String.match(s,a["."])||!a["."]&&String.match(e,a["#"])||!a["#"]&&String.match(s,a["."])||String.match(e?e+"/"+s:s,a["#"]||a)){if(a["+"]&&a["+"].indexOf("*")>-1&&e&&-1==e.indexOf(i)&&-1==s.indexOf(i))return l(`Path "${e}" or key "${s}" must contain string "${i}".`);if(n.wb&&("string"==typeof n.wb||(n.wb||{})["#"])){var r=t.as.root.$.back(-1);return"string"==typeof n.wb&&"~"!==n.wb.slice(0,1)&&(r=r.get("~"+h)),r.get(n.wb).get(i).once((t=>!t||1!==t&&!0!==t?u(n):l(`Certificant ${i} blocked.`)))}return u(n)}return l("Certificate verification fail.")}}))};if("pub"===s&&"~"+h===c)return n===h?t.to.next(e):l("Account not same!");(d=p.is)&&d.pub&&!g["*"]&&!g["+"]&&(h===d.pub||h!==d.pub&&((e._.msg||{}).opt||{}).cert)?r.opt.pack(e.put,(a=>{r.sign(a,p._.sea,(async function(a){if(o===a)return l(r.err||"Signature fail.");if(e.put[":"]={":":d=r.opt.unpack(a.m),"~":a.s},e.put["="]=d,h===p.is.pub)return(d=u(n))&&((f.sea.own[d]=f.sea.own[d]||{})[h]=1),void JSON.stringifyAsync(e.put[":"],(function(n,o){return n?l(n||"Stringify error."):(e.put[":"]=o,t.to.next(e))}));if(h!==p.is.pub&&((e._.msg||{}).opt||{}).cert){const n=await i.parse(e._.msg.opt.cert);n&&n.m&&n.s&&y(n,p.is.pub,(o=>{e.put[":"]["+"]=n,e.put[":"]["*"]=p.is.pub,JSON.stringifyAsync(e.put[":"],(function(n,o){return n?l(n||"Stringify error."):(e.put[":"]=o,t.to.next(e))}))}))}}),{raw:1})})):r.opt.pack(e.put,(n=>{r.verify(n,g["*"]||h,(function(n){var i;return n=r.opt.unpack(n),o===n?l("Unverified data."):((i=u(n))&&h===r.opt.pub(i)&&((f.sea.own[i]=f.sea.own[i]||{})[h]=1),g["+"]&&g["+"].m&&g["+"].s&&g["*"]?void y(g["+"],g["*"],(o=>(e.put["="]=n,t.to.next(e)))):(e.put["="]=n,t.to.next(e)))}))}))},s.any=function(t,e,n,o,r,i,a,s){if(i.opt.secure)return a("Soul missing public key at '"+o+"'.");i.on("secure",(function(e){if(this.off(),!i.opt.secure)return t.to.next(e);a("Data cannot be changed.")})).on.on("secure",e)};var c=a.valid,u=function(t,e){return"string"==typeof(e=c(t))&&e};(a.state||"").ify;var f=/[^\w_-]/;r.opt.pub=function(t){if(t&&(t=t.split("~"))&&(t=t[1])&&(t=t.split(f).slice(0,2))&&2==t.length&&"@"!==(t[0]||"")[0])return t=t.slice(0,2).join(".")},r.opt.stringy=function(t){},r.opt.pack=function(t,e,n,i,s){var c,u;if(r.opt.check(t))return e(t);t&&t["#"]&&t["."]&&t[">"]&&(c=t[":"],u=1),JSON.parseAsync(u?c:t,(function(r,c){var u=o!==(c||"")[":"]&&(c||"")["~"];e(u?{m:{"#":s||t["#"],".":n||t["."],":":(c||"")[":"],">":t[">"]||a.state.is(i,n)},s:u}:t)}))};var l=r.opt;r.opt.unpack=function(t,e,n){var i;if(o!==t){if(t&&o!==(i=t[":"]))return i;if(e=e||l.fall_key,!n&&l.fall_val&&((n={})[e]=l.fall_val),e&&n){if(t===n[e])return t;if(!r.opt.check(n[e]))return t;var s=n&&n._&&n._["#"]||l.fall_soul,c=a.state.is(n,e)||l.fall_state;return t&&4===t.length&&s===t[0]&&e===t[1]&&p(c)===p(t[3])?t[2]:c<r.opt.shuffle_attack?t:void 0}}},r.opt.shuffle_attack=15463296e5;var p=Math.floor}))(e,"./index")}()}(ft);var lt=ut.SEA;ut.chain.subscribe=function(t){let e=this;if(!!(e._.back||{}).each){let n=new Map;t(Array.from(n)),e=e.on(((e,o,r)=>{let i=ut.node.soul(e)||r.via.soul||o;n.set(i,e),t(Array.from(n))}))}else e=e.on(t);return e.off};const pt=async()=>{const t=localStorage.getItem("userPair");if(t)ht.user().auth(JSON.parse(t));else{const t=await lt.pair();ht.user().auth(t),localStorage.setItem("userPair",JSON.stringify(t))}},ht=ut(),dt=ht.user();function gt(t){let e,n,o,r,i,a,s;const d=t[8].default,g=function(t,e,n,o){if(t){const r=c(t,e,n,o);return t[0](r)}}(d,t,t[7],null);return{c(){e=h("button"),n=h("span"),g&&g.c(),m(n,"class",o=u(`\n      ${t[4]&&t[2]&&"white-override"}\n    ${t[4]&&"text-gray-400 cursor-not-allowed"}\n    ${t[0]&&"text-black"} items-center content-center text-center ${t[5]&&t[5]>0&&"mix-blend-difference"}`)+" svelte-tvya5x"),e.disabled=t[4],m(e,"type",t[1]),m(e,"title",t[3]),k(e,"--theme-fill",t[5]+"%"),m(e,"class",r=u(`\n  ${t[0]?"bg-white":"bg-action"} \n  ${t[2]&&"wide"}\n  ${t[4]&&"cursor-not-allowed"}\n  rounded-[10px] px-3 py-2 t_btn`)+" svelte-tvya5x")},m(o,r){l(o,e,r),f(e,n),g&&g.m(n,null),i=!0,a||(s=v(e,"click",t[9]),a=!0)},p(t,[a]){g&&g.p&&(!i||128&a)&&function(t,e,n,o,r,i){if(r){const a=c(e,n,o,i);t.p(a,r)}}(g,d,t,t[7],i?function(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}(d,t[7],a,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[7]),null),(!i||53&a&&o!==(o=u(`\n      ${t[4]&&t[2]&&"white-override"}\n    ${t[4]&&"text-gray-400 cursor-not-allowed"}\n    ${t[0]&&"text-black"} items-center content-center text-center ${t[5]&&t[5]>0&&"mix-blend-difference"}`)+" svelte-tvya5x"))&&m(n,"class",o),(!i||16&a)&&(e.disabled=t[4]),(!i||2&a)&&m(e,"type",t[1]),(!i||8&a)&&m(e,"title",t[3]),(!i||32&a)&&k(e,"--theme-fill",t[5]+"%"),(!i||21&a&&r!==(r=u(`\n  ${t[0]?"bg-white":"bg-action"} \n  ${t[2]&&"wide"}\n  ${t[4]&&"cursor-not-allowed"}\n  rounded-[10px] px-3 py-2 t_btn`)+" svelte-tvya5x"))&&m(e,"class",r)},i(t){i||(W(g,t),i=!0)},o(t){Y(g,t),i=!1},d(t){t&&p(e),g&&g.d(t),a=!1,s()}}}function yt(t,e,n){let{$$slots:o={},$$scope:r}=e;const i=A();let{isActive:a=!1}=e,{type:s="button"}=e,{wide:c=!1}=e,{tooltip:u=""}=e,{disabled:f=!1}=e,{progress:l=0}=e;return t.$$set=t=>{"isActive"in t&&n(0,a=t.isActive),"type"in t&&n(1,s=t.type),"wide"in t&&n(2,c=t.wide),"tooltip"in t&&n(3,u=t.tooltip),"disabled"in t&&n(4,f=t.disabled),"progress"in t&&n(5,l=t.progress),"$$scope"in t&&n(7,r=t.$$scope)},[a,s,c,u,f,l,i,r,o,()=>{i("click")}]}class vt extends ot{constructor(t){super(),nt(this,t,yt,gt,a,{isActive:0,type:1,wide:2,tooltip:3,disabled:4,progress:5})}}function mt(t){let e;return{c(){e=d("mp3")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function bt(t){let e;return{c(){e=d("flac")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function wt(t){let e;return{c(){e=d("wav")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function kt(t){let e;return{c(){e=d("lo-fi")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function $t(t){let e;return{c(){e=d("mid-fi")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function xt(t){let e;return{c(){e=d("hi-fi")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function _t(t){let e;return{c(){e=d(t[2])},m(t,n){l(t,e,n)},p(t,n){4&n&&b(e,t[2])},d(t){t&&p(e)}}}function St(t){let e,n,o,i,a,s,c,u,d,y,b,k,$,x,_,S,j,A,O,T,E,D,B,C,N;s=new vt({props:{isActive:Boolean("mp3"===t[4]),$$slots:{default:[mt]},$$scope:{ctx:t}}}),s.$on("click",t[10]),u=new vt({props:{isActive:Boolean("flac"===t[4]),$$slots:{default:[bt]},$$scope:{ctx:t}}}),u.$on("click",t[11]),y=new vt({props:{isActive:Boolean("wav"===t[4]),tooltip:"coming very, very soon!",disabled:!0,$$slots:{default:[wt]},$$scope:{ctx:t}}}),y.$on("click",t[12]),$=new vt({props:{isActive:Boolean("lowest"===t[5]),$$slots:{default:[kt]},$$scope:{ctx:t}}}),$.$on("click",t[13]),_=new vt({props:{isActive:Boolean("medium"===t[5]),$$slots:{default:[$t]},$$scope:{ctx:t}}}),_.$on("click",t[14]),j=new vt({props:{isActive:Boolean("highest"===t[5]),$$slots:{default:[xt]},$$scope:{ctx:t}}}),j.$on("click",t[15]),O=new vt({props:{progress:t[3],wide:!0,disabled:t[6],$$slots:{default:[_t]},$$scope:{ctx:t}}}),O.$on("click",t[7]);let P=jt;return{c(){e=h("div"),n=h("form"),o=h("input"),i=g(),a=h("div"),Z(s.$$.fragment),c=g(),Z(u.$$.fragment),d=g(),Z(y.$$.fragment),b=g(),k=h("div"),Z($.$$.fragment),x=g(),Z(_.$$.fragment),S=g(),Z(j.$$.fragment),A=g(),Z(O.$$.fragment),T=g(),E=h("br"),D=g(),m(o,"type","text"),m(o,"placeholder","youtube url"),m(o,"class","bg-action mb-[12px] h-8 rounded-2xl py-2 px-3 text-center text-white placeholder-white svelte-1ipbn1z"),m(a,"class","mx-[54px] mb-[12px]"),m(k,"class","mx-[54px] mb-[12px]"),m(n,"class","flex flex-col content-center items-center"),m(e,"class","align-center flex flex-col content-center items-center text-white")},m(r,p){var h;l(r,e,p),f(e,n),f(n,o),w(o,t[0]),f(n,i),f(n,a),tt(s,a,null),f(a,c),tt(u,a,null),f(a,d),tt(y,a,null),f(n,b),f(n,k),tt($,k,null),f(k,x),tt(_,k,null),f(k,S),tt(j,k,null),f(n,A),tt(O,n,null),f(n,T),f(n,E),f(e,D),B=!0,C||(N=[v(o,"input",t[9]),v(n,"submit",(h=t[7],function(t){return t.preventDefault(),h.call(this,t)}))],C=!0)},p(t,[e]){1&e&&o.value!==t[0]&&w(o,t[0]);const n={};16&e&&(n.isActive=Boolean("mp3"===t[4])),524288&e&&(n.$$scope={dirty:e,ctx:t}),s.$set(n);const r={};16&e&&(r.isActive=Boolean("flac"===t[4])),524288&e&&(r.$$scope={dirty:e,ctx:t}),u.$set(r);const i={};16&e&&(i.isActive=Boolean("wav"===t[4])),524288&e&&(i.$$scope={dirty:e,ctx:t}),y.$set(i);const a={};32&e&&(a.isActive=Boolean("lowest"===t[5])),524288&e&&(a.$$scope={dirty:e,ctx:t}),$.$set(a);const c={};32&e&&(c.isActive=Boolean("medium"===t[5])),524288&e&&(c.$$scope={dirty:e,ctx:t}),_.$set(c);const f={};32&e&&(f.isActive=Boolean("highest"===t[5])),524288&e&&(f.$$scope={dirty:e,ctx:t}),j.$set(f);const l={};8&e&&(l.progress=t[3]),64&e&&(l.disabled=t[6]),524292&e&&(l.$$scope={dirty:e,ctx:t}),O.$set(l)},i(t){B||(W(s.$$.fragment,t),W(u.$$.fragment,t),W(y.$$.fragment,t),W($.$$.fragment,t),W(_.$$.fragment,t),W(j.$$.fragment,t),W(O.$$.fragment,t),W(P),B=!0)},o(t){Y(s.$$.fragment,t),Y(u.$$.fragment,t),Y(y.$$.fragment,t),Y($.$$.fragment,t),Y(_.$$.fragment,t),Y(j.$$.fragment,t),Y(O.$$.fragment,t),Y(P),B=!1},d(t){t&&p(e),et(s),et(u),et(y),et($),et(_),et(j),et(O),C=!1,r(N)}}}let jt=!1;function At(t,e,n){const o=window.ipc;let r,i=O("AppContext"),a="",s="download",c=0,u="flac",f="highest",l=!1;o.on("download_finished",(t=>{t.success?(n(2,s="finished"),n(3,c=0),n(6,l=!1),setTimeout((()=>{n(2,s="download"),n(6,l=!1)}),1e3)):(n(2,s="error"),console.log(t.err))})),o.on("progress_update",(t=>{n(3,c=t)})),j((async()=>{i.setBg(1),dt.is||await pt(),dt.get("preferences").get("save_dir").on((t=>{n(1,a=t),n(1,a)}))}));return[r,a,s,c,u,f,l,()=>{r?a?(n(6,l=!0),n(2,s="downloading..."),o.send("start_download",{url:r,dirPath:a,container:u,quality:f})):o.send("alert",{title:"heads up",message:"please choose a place to save your music"}):o.send("alert",{title:"heads up",message:"please input a url"})},async()=>{console.log("attempted to invoke update window preview"),await o.invoke("show_update_window")},function(){r=this.value,n(0,r)},()=>n(4,u="mp3"),()=>n(4,u="flac"),()=>n(4,u="wav"),()=>n(5,f="lowest"),()=>n(5,f="medium"),()=>n(5,f="highest"),()=>{dt.get("preferences").get("save_dir").put(null)}]}class Ot extends ot{constructor(t){super(),nt(this,t,At,St,a,{})}}var Tt=Math.floor,Et=Math.random;var Dt=function(t,e){return t+Tt(Et()*(e-t+1))};var Bt=function(t){var e=t.length;return e?t[Dt(0,e-1)]:void 0};var Ct=function(t,e){for(var n=-1,o=null==t?0:t.length,r=Array(o);++n<o;)r[n]=e(t[n],n,t);return r};var Nt=function(t,e){return Ct(e,(function(e){return t[e]}))};var Pt=function(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o},Ut="object"==typeof rt&&rt&&rt.Object===Object&&rt,Gt=Ut,It="object"==typeof self&&self&&self.Object===Object&&self,Mt=Gt||It||Function("return this")(),Jt=Mt.Symbol,Ht=Jt,Kt=Object.prototype,Rt=Kt.hasOwnProperty,qt=Kt.toString,Lt=Ht?Ht.toStringTag:void 0;var Ft=function(t){var e=Rt.call(t,Lt),n=t[Lt];try{t[Lt]=void 0;var o=!0}catch(t){}var r=qt.call(t);return o&&(e?t[Lt]=n:delete t[Lt]),r},Wt=Object.prototype.toString;var Yt=Ft,zt=function(t){return Wt.call(t)},Vt=Jt?Jt.toStringTag:void 0;var Xt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Vt&&Vt in Object(t)?Yt(t):zt(t)};var Qt=function(t){return null!=t&&"object"==typeof t},Zt=Xt,te=Qt;var ee=function(t){return te(t)&&"[object Arguments]"==Zt(t)},ne=Qt,oe=Object.prototype,re=oe.hasOwnProperty,ie=oe.propertyIsEnumerable,ae=ee(function(){return arguments}())?ee:function(t){return ne(t)&&re.call(t,"callee")&&!ie.call(t,"callee")},se=Array.isArray,ce={exports:{}};var ue=function(){return!1};!function(t,e){var n=Mt,o=ue,r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,a=i&&i.exports===r?n.Buffer:void 0,s=(a?a.isBuffer:void 0)||o;t.exports=s}(ce,ce.exports);var fe=ce.exports,le=/^(?:0|[1-9]\d*)$/;var pe=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&le.test(t))&&t>-1&&t%1==0&&t<e};var he=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},de=Xt,ge=he,ye=Qt,ve={};ve["[object Float32Array]"]=ve["[object Float64Array]"]=ve["[object Int8Array]"]=ve["[object Int16Array]"]=ve["[object Int32Array]"]=ve["[object Uint8Array]"]=ve["[object Uint8ClampedArray]"]=ve["[object Uint16Array]"]=ve["[object Uint32Array]"]=!0,ve["[object Arguments]"]=ve["[object Array]"]=ve["[object ArrayBuffer]"]=ve["[object Boolean]"]=ve["[object DataView]"]=ve["[object Date]"]=ve["[object Error]"]=ve["[object Function]"]=ve["[object Map]"]=ve["[object Number]"]=ve["[object Object]"]=ve["[object RegExp]"]=ve["[object Set]"]=ve["[object String]"]=ve["[object WeakMap]"]=!1;var me=function(t){return ye(t)&&ge(t.length)&&!!ve[de(t)]};var be=function(t){return function(e){return t(e)}},we={exports:{}};!function(t,e){var n=Ut,o=e&&!e.nodeType&&e,r=o&&t&&!t.nodeType&&t,i=r&&r.exports===o&&n.process,a=function(){try{var t=r&&r.require&&r.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=a}(we,we.exports);var ke=we.exports,$e=me,xe=be,_e=ke&&ke.isTypedArray,Se=_e?xe(_e):$e,je=Pt,Ae=ae,Oe=se,Te=fe,Ee=pe,De=Se,Be=Object.prototype.hasOwnProperty;var Ce=function(t,e){var n=Oe(t),o=!n&&Ae(t),r=!n&&!o&&Te(t),i=!n&&!o&&!r&&De(t),a=n||o||r||i,s=a?je(t.length,String):[],c=s.length;for(var u in t)!e&&!Be.call(t,u)||a&&("length"==u||r&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ee(u,c))||s.push(u);return s},Ne=Object.prototype;var Pe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ne)};var Ue=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),Ge=Pe,Ie=Ue,Me=Object.prototype.hasOwnProperty;var Je=Xt,He=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var Ke=function(t){if(!He(t))return!1;var e=Je(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Re=he;var qe=Ce,Le=function(t){if(!Ge(t))return Ie(t);var e=[];for(var n in Object(t))Me.call(t,n)&&"constructor"!=n&&e.push(n);return e},Fe=function(t){return null!=t&&Re(t.length)&&!Ke(t)};var We=Nt,Ye=function(t){return Fe(t)?qe(t):Le(t)};var ze=Bt,Ve=function(t){return null==t?[]:We(t,Ye(t))};var Xe=Bt,Qe=function(t){return ze(Ve(t))},Ze=se;var tn=it((function(t){return(Ze(t)?Xe:Qe)(t)}));function en(t){if(!t)throw Error("Parameter args is required");if(!t.component==!t.asyncComponent)throw Error("One and only one of component and asyncComponent is required");if(t.component&&(t.asyncComponent=()=>Promise.resolve(t.component)),"function"!=typeof t.asyncComponent)throw Error("Parameter asyncComponent must be a function");if(t.conditions){Array.isArray(t.conditions)||(t.conditions=[t.conditions]);for(let e=0;e<t.conditions.length;e++)if(!t.conditions[e]||"function"!=typeof t.conditions[e])throw Error("Invalid parameter conditions["+e+"]")}t.loadingComponent&&(t.asyncComponent.loading=t.loadingComponent,t.asyncComponent.loadingParams=t.loadingParams||void 0);return{component:t.asyncComponent,userData:t.userData,conditions:t.conditions&&t.conditions.length?t.conditions:void 0,props:t.props&&Object.keys(t.props).length?t.props:{},_sveltesparouter:!0}}const nn=[];function on(t,e){return{subscribe:rn(t,e).subscribe}}function rn(e,n=t){let o;const r=new Set;function i(t){if(a(e,t)&&(e=t,o)){const t=!nn.length;for(const t of r)t[1](),nn.push(t,e);if(t){for(let t=0;t<nn.length;t+=2)nn[t][0](nn[t+1]);nn.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(a,s=t){const c=[a,s];return r.add(c),1===r.size&&(o=n(i)||t),a(e),()=>{r.delete(c),0===r.size&&o&&(o(),o=null)}}}}function an(e,n,o){const a=!Array.isArray(e),c=a?[e]:e,u=n.length<2;return on(o,(e=>{let o=!1;const f=[];let l=0,p=t;const h=()=>{if(l)return;p();const o=n(a?f[0]:f,e);u?e(o):p=i(o)?o:t},d=c.map(((t,e)=>s(t,(t=>{f[e]=t,l&=~(1<<e),o&&h()}),(()=>{l|=1<<e}))));return o=!0,h(),function(){r(d),p(),o=!1}}))}function sn(t){let n,o,r;const i=[t[2]];var a=t[0];function s(t){let n={};for(let t=0;t<i.length;t+=1)n=e(n,i[t]);return{props:n}}return a&&(n=$(a,s()),n.$on("routeEvent",t[7])),{c(){n&&Z(n.$$.fragment),o=y()},m(t,e){n&&tt(n,t,e),l(t,o,e),r=!0},p(t,e){const r=4&e?X(i,[Q(t[2])]):{};if(1&e&&a!==(a=t[0])){if(n){L();const t=n;Y(t.$$.fragment,1,0,(()=>{et(t,1)})),F()}a?(n=$(a,s()),n.$on("routeEvent",t[7]),Z(n.$$.fragment),W(n.$$.fragment,1),tt(n,o.parentNode,o)):n=null}else a&&n.$set(r)},i(t){r||(n&&W(n.$$.fragment,t),r=!0)},o(t){n&&Y(n.$$.fragment,t),r=!1},d(t){t&&p(o),n&&et(n,t)}}}function cn(t){let n,o,r;const i=[{params:t[1]},t[2]];var a=t[0];function s(t){let n={};for(let t=0;t<i.length;t+=1)n=e(n,i[t]);return{props:n}}return a&&(n=$(a,s()),n.$on("routeEvent",t[6])),{c(){n&&Z(n.$$.fragment),o=y()},m(t,e){n&&tt(n,t,e),l(t,o,e),r=!0},p(t,e){const r=6&e?X(i,[2&e&&{params:t[1]},4&e&&Q(t[2])]):{};if(1&e&&a!==(a=t[0])){if(n){L();const t=n;Y(t.$$.fragment,1,0,(()=>{et(t,1)})),F()}a?(n=$(a,s()),n.$on("routeEvent",t[6]),Z(n.$$.fragment),W(n.$$.fragment,1),tt(n,o.parentNode,o)):n=null}else a&&n.$set(r)},i(t){r||(n&&W(n.$$.fragment,t),r=!0)},o(t){n&&Y(n.$$.fragment,t),r=!1},d(t){t&&p(o),n&&et(n,t)}}}function un(t){let e,n,o,r;const i=[cn,sn],a=[];function s(t,e){return t[1]?0:1}return e=s(t),n=a[e]=i[e](t),{c(){n.c(),o=y()},m(t,n){a[e].m(t,n),l(t,o,n),r=!0},p(t,[r]){let c=e;e=s(t),e===c?a[e].p(t,r):(L(),Y(a[c],1,1,(()=>{a[c]=null})),F(),n=a[e],n?n.p(t,r):(n=a[e]=i[e](t),n.c()),W(n,1),n.m(o.parentNode,o))},i(t){r||(W(n),r=!0)},o(t){Y(n),r=!1},d(t){a[e].d(t),t&&p(o)}}}function fn(){const t=window.location.href.indexOf("#/");let e=t>-1?window.location.href.substr(t+1):"/";const n=e.indexOf("?");let o="";return n>-1&&(o=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:o}}const ln=on(null,(function(t){t(fn());const e=()=>{t(fn())};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}})),pn=an(ln,(t=>t.location));an(ln,(t=>t.querystring));const hn=rn(void 0);async function dn(t){if(!t||t.length<1||"/"!=t.charAt(0)&&0!==t.indexOf("#/"))throw Error("Invalid parameter location");await G(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=("#"==t.charAt(0)?"":"#")+t}function gn(t,e,n){let{routes:o={}}=e,{prefix:r=""}=e,{restoreScrollState:i=!1}=e;class a{match(t){if(r)if("string"==typeof r){if(!t.startsWith(r))return null;t=t.substr(r.length)||"/"}else if(r instanceof RegExp){const e=t.match(r);if(!e||!e[0])return null;t=t.substr(e[0].length)||"/"}const e=this._pattern.exec(t);if(null===e)return null;if(!1===this._keys)return e;const n={};let o=0;for(;o<this._keys.length;){try{n[this._keys[o]]=decodeURIComponent(e[o+1]||"")||null}catch(t){n[this._keys[o]]=null}o++}return n}async checkConditions(t){for(let e=0;e<this.conditions.length;e++)if(!await this.conditions[e](t))return!1;return!0}constructor(t,e){if(!e||"function"!=typeof e&&("object"!=typeof e||!0!==e._sveltesparouter))throw Error("Invalid component object");if(!t||"string"==typeof t&&(t.length<1||"/"!=t.charAt(0)&&"*"!=t.charAt(0))||"object"==typeof t&&!(t instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:n,keys:o}=function(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,o,r,i,a=[],s="",c=t.split("/");for(c[0]||c.shift();r=c.shift();)"*"===(n=r[0])?(a.push("wild"),s+="/(.*)"):":"===n?(o=r.indexOf("?",1),i=r.indexOf(".",1),a.push(r.substring(1,~o?o:~i?i:r.length)),s+=~o&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(s+=(~o?"?":"")+"\\"+r.substring(i))):s+="/"+r;return{keys:a,pattern:new RegExp("^"+s+(e?"(?=$|/)":"/?$"),"i")}}(t);this.path=t,"object"==typeof e&&!0===e._sveltesparouter?(this.component=e.component,this.conditions=e.conditions||[],this.userData=e.userData,this.props=e.props||{}):(this.component=()=>Promise.resolve(e),this.conditions=[],this.props={}),this._pattern=n,this._keys=o}}const s=[];o instanceof Map?o.forEach(((t,e)=>{s.push(new a(e,t))})):Object.keys(o).forEach((t=>{s.push(new a(t,o[t]))}));let c=null,u=null,f={};const l=A();async function p(t,e){await G(),l(t,e)}let h=null,d=null;var g;i&&(d=t=>{h=t.state&&(t.state.__svelte_spa_router_scrollY||t.state.__svelte_spa_router_scrollX)?t.state:null},window.addEventListener("popstate",d),g=()=>{var t;(t=h)?window.scrollTo(t.__svelte_spa_router_scrollX,t.__svelte_spa_router_scrollY):window.scrollTo(0,0)},S().$$.after_update.push(g));let y=null,v=null;const m=ln.subscribe((async t=>{y=t;let e=0;for(;e<s.length;){const o=s[e].match(t.location);if(!o){e++;continue}const r={route:s[e].path,location:t.location,querystring:t.querystring,userData:s[e].userData,params:o&&"object"==typeof o&&Object.keys(o).length?o:null};if(!await s[e].checkConditions(r))return n(0,c=null),v=null,void p("conditionsFailed",r);p("routeLoading",Object.assign({},r));const i=s[e].component;if(v!=i){i.loading?(n(0,c=i.loading),v=i,n(1,u=i.loadingParams),n(2,f={}),p("routeLoaded",Object.assign({},r,{component:c,name:c.name,params:u}))):(n(0,c=null),v=null);const e=await i();if(t!=y)return;n(0,c=e&&e.default||e),v=i}return o&&"object"==typeof o&&Object.keys(o).length?n(1,u=o):n(1,u=null),n(2,f=s[e].props),void p("routeLoaded",Object.assign({},r,{component:c,name:c.name,params:u})).then((()=>{hn.set(u)}))}n(0,c=null),v=null,hn.set(void 0)}));return function(t){S().$$.on_destroy.push(t)}((()=>{m(),d&&window.removeEventListener("popstate",d)})),t.$$set=t=>{"routes"in t&&n(3,o=t.routes),"prefix"in t&&n(4,r=t.prefix),"restoreScrollState"in t&&n(5,i=t.restoreScrollState)},t.$$.update=()=>{32&t.$$.dirty&&(history.scrollRestoration=i?"manual":"auto")},[c,u,f,o,r,i,function(e){T.call(this,t,e)},function(e){T.call(this,t,e)}]}class yn extends ot{constructor(t){super(),nt(this,t,gn,un,a,{routes:3,prefix:4,restoreScrollState:5})}}function vn(e){return{c:t,m:t,p:t,d:t}}function mn(t){let e,n=(t[0].justSetup?"download":tn(t[3]))+"";return{c(){e=d(n)},m(t,n){l(t,e,n)},p(t,o){1&o&&n!==(n=(t[0].justSetup?"download":tn(t[3]))+"")&&b(e,n)},d(t){t&&p(e)}}}function bn(e){return{c:t,m:t,p:t,d:t}}function wn(t){let e,n,o,r,i,a,s,c,u,d,y={ctx:t,current:null,token:null,hasCatch:!1,pending:bn,then:mn,catch:vn,value:3};return z(window.ipc.invoke("get_quips"),y),i=new Ot({}),{c(){e=h("div"),n=h("h1"),y.block.c(),o=g(),r=h("div"),Z(i.$$.fragment),a=g(),s=h("button"),s.textContent="change folder",m(n,"class","absolute top-24 mr-2 w-full text-center text-4xl text-white"),m(r,"class","flex h-full flex-col items-center justify-center align-middle"),m(s,"class","absolute bottom-2 left-1/2 z-10 -translate-x-1/2 text-white"),m(e,"class","h-full w-screen")},m(p,h){l(p,e,h),f(e,n),y.block.m(n,y.anchor=null),y.mount=()=>n,y.anchor=null,f(e,o),f(e,r),tt(i,r,null),f(e,a),f(e,s),c=!0,u||(d=v(s,"click",t[1],{once:!0}),u=!0)},p(e,[n]){V(y,t=e,n)},i(t){c||(W(i.$$.fragment,t),c=!0)},o(t){Y(i.$$.fragment,t),c=!1},d(t){t&&p(e),y.block.d(),y.token=null,y=null,et(i),u=!1,d()}}}function kn(t,e,n){let{params:o={}}=e,r=O("AppContext");j((()=>{r.setBg(tn([1,4,5,6]))}));return t.$$set=t=>{"params"in t&&n(0,o=t.params)},[o,()=>dn("/setup")]}class $n extends ot{constructor(t){super(),nt(this,t,kn,wn,a,{params:0})}}function xn(t){return j((async()=>{await pt(),dt.get("preferences").get("save_dir").once((t=>(console.log(t,null),t?void dn("/download"):void dn("/setup"))))})),[]}class _n extends ot{constructor(t){super(),nt(this,t,xn,null,a,{})}}function Sn(t){let e;return{c(){e=d("select folder")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function jn(t){let e,n,o,r,i,a;return i=new vt({props:{$$slots:{default:[Sn]},$$scope:{ctx:t}}}),i.$on("click",t[2]),{c(){e=h("div"),n=h("h1"),n.textContent="where should i put your music?",o=g(),r=h("div"),Z(i.$$.fragment),m(n,"class","absolute top-24 w-full text-center text-4xl text-white"),m(r,"class","flex h-full flex-col items-center justify-center justify-evenly align-middle"),m(e,"class","h-full w-screen")},m(t,s){l(t,e,s),f(e,n),f(e,o),f(e,r),tt(i,r,null),a=!0},p(t,[e]){const n={};8&e&&(n.$$scope={dirty:e,ctx:t}),i.$set(n)},i(t){a||(W(i.$$.fragment,t),a=!0)},o(t){Y(i.$$.fragment,t),a=!1},d(t){t&&p(e),et(i)}}}function An(t){const e=window.ipc;let n=O("AppContext");j((()=>{setTimeout((()=>n.setBg(2)),100)}));return[e,n,async()=>{n.setBg(3),e.invoke("get_save_dir").then((t=>{console.log(t),t&&dt.get("preferences").get("save_dir").put(t,(()=>dn("/download/true")))}))}]}class On extends ot{constructor(t){super(),nt(this,t,An,jn,a,{})}}function Tn(t){let e;return{c(){e=h("span"),e.innerHTML='<img src="icon.png" alt="Theia App Icon" class="h-[24px] px-[4px] py-0"/><span>Theia</span>',m(e,"class","h-full flex items-center text-white font-[system-ui] text-sm")},m(t,n){l(t,e,n)},d(t){t&&p(e)}}}function En(t){let e,n,o={ctx:t,current:null,token:null,hasCatch:!1,pending:Cn,then:Bn,catch:Dn,value:4};return z(window.ipc.invoke("get_app_version"),o),{c(){e=h("div"),n=h("span"),o.block.c(),m(n,"class","h-full px-[6px] flex items-center text-white font-[system-ui] text-sm"),m(e,"class","w-screen h-[26px] absolute bottom-0")},m(t,r){l(t,e,r),f(e,n),o.block.m(n,o.anchor=null),o.mount=()=>n,o.anchor=null},p(e,n){V(o,t=e,n)},d(t){t&&p(e),o.block.d(),o.token=null,o=null}}}function Dn(e){return{c:t,m:t,p:t,d:t}}function Bn(t){let e,n,o,r=t[4]+"";return{c(){e=d(r),n=g(),o=d(t[0])},m(t,r){l(t,e,r),l(t,n,r),l(t,o,r)},p(t,e){1&e&&b(o,t[0])},d(t){t&&p(e),t&&p(n),t&&p(o)}}}function Cn(e){return{c:t,m:t,p:t,d:t}}function Nn(t){let e,n,o,r,i,a,s,c,u="win32"===t[0]&&"/updating"!==t[2]&&Tn();i=new yn({props:{routes:t[3]}});let d="/updating"!==t[2]&&En(t);return{c(){e=h("main"),n=h("div"),u&&u.c(),r=g(),Z(i.$$.fragment),a=g(),d&&d.c(),m(n,"class",o="w-screen h-[29px] "+("win32"===t[0]&&"/updating"!==t[2]?"bg-black":"")),k(n,"-webkit-app-region","drag"),m(e,"class",s=`bg-main-grad h-screen bg_${t[1]}`)},m(t,o){l(t,e,o),f(e,n),u&&u.m(n,null),f(e,r),tt(i,e,null),f(e,a),d&&d.m(e,null),c=!0},p(t,[r]){"win32"===t[0]&&"/updating"!==t[2]?u||(u=Tn(),u.c(),u.m(n,null)):u&&(u.d(1),u=null),(!c||5&r&&o!==(o="w-screen h-[29px] "+("win32"===t[0]&&"/updating"!==t[2]?"bg-black":"")))&&m(n,"class",o),"/updating"!==t[2]?d?d.p(t,r):(d=En(t),d.c(),d.m(e,null)):d&&(d.d(1),d=null),(!c||2&r&&s!==(s=`bg-main-grad h-screen bg_${t[1]}`))&&m(e,"class",s)},i(t){c||(W(i.$$.fragment,t),c=!0)},o(t){Y(i.$$.fragment,t),c=!1},d(t){t&&p(e),u&&u.d(),et(i),d&&d.d()}}}function Pn(t,e,n){let o,r;var i,a;let c;i=pn,a=t=>n(2,r=t),t.$$.on_destroy.push(s(i,a)),j((()=>{console.log(r),console.log(false),console.log(null),n(0,c=window.env.platform()),console.log(c)}));const u={"/":_n,"/download/:justSetup?":$n,"/setup":On,"/updating":en({asyncComponent:()=>import("./updating-a1f6bc1e.js")})};var f,l;return f="AppContext",l={setBg:t=>n(1,o=t)},S().$$.context.set(f,l),n(1,o=1),[c,o,r,u]}const Un=new class extends ot{constructor(t){super(),nt(this,t,Pn,Nn,a,{})}}({target:document.body});export{ot as S,m as a,l as b,Un as c,p as d,h as e,O as g,nt as i,t as n,j as o,a as s};
//# sourceMappingURL=main-1d7bef4a.js.map
